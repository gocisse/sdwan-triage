<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SD-WAN Network Triage - TestFile4.pcap</title>
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    
    <style>/* ============================================================================
   SD-WAN Triage - Enterprise Dashboard CSS
   Inspired by Motadata and ManageEngine OpManager
   Modern, Clean, Professional Network Management UI
   ============================================================================ */

/* ============================================================================
   1. CSS VARIABLES - DESIGN SYSTEM
   ============================================================================ */
:root {
    /* Primary Color Palette */
    --color-primary: #0055A4;
    --color-primary-dark: #003366;
    --color-primary-light: #0066CC;
    
    /* Secondary & Background Colors */
    --color-secondary: #F5F7FA;
    --color-background: #FFFFFF;
    --color-surface: #FAFBFC;
    --color-border: #E1E8ED;
    --color-border-light: #F0F3F7;
    
    /* Accent Colors */
    --color-success: #00B894;
    --color-success-light: #E8F8F5;
    --color-warning: #FDCB6E;
    --color-warning-light: #FFF9E6;
    --color-critical: #E17055;
    --color-critical-light: #FFE8E3;
    --color-info: #74B9FF;
    --color-info-light: #E3F2FD;
    
    /* Text Colors */
    --color-text-primary: #2D3436;
    --color-text-secondary: #636E72;
    --color-text-muted: #95A5A6;
    --color-text-inverse: #FFFFFF;
    
    /* Status Colors */
    --color-healthy: #00B894;
    --color-warning-status: #FDCB6E;
    --color-critical-status: #E17055;
    --color-unknown: #95A5A6;
    
    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    
    /* Border Radius */
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;
    --radius-full: 9999px;
    
    /* Spacing Scale */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 2rem;
    --space-2xl: 3rem;
    --space-3xl: 4rem;
    
    /* Typography */
    --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    --font-family-mono: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;
    --font-size-2xl: 1.5rem;
    --font-size-3xl: 1.875rem;
    --font-size-4xl: 2.25rem;
    
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    
    /* Transitions */
    --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Z-Index Scale */
    --z-dropdown: 1000;
    --z-sticky: 1020;
    --z-fixed: 1030;
    --z-modal-backdrop: 1040;
    --z-modal: 1050;
    --z-popover: 1060;
    --z-tooltip: 1070;
}

/* ============================================================================
   2. RESET & BASE STYLES
   ============================================================================ */
*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font-family: var(--font-family);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-normal);
    line-height: 1.6;
    color: var(--color-text-primary);
    background-color: var(--color-secondary);
    overflow-x: hidden;
}

/* ============================================================================
   3. TYPOGRAPHY
   ============================================================================ */
h1, h2, h3, h4, h5, h6 {
    font-weight: var(--font-weight-semibold);
    line-height: 1.3;
    color: var(--color-text-primary);
    margin-bottom: var(--space-md);
}

h1 { font-size: var(--font-size-3xl); }
h2 { font-size: var(--font-size-2xl); }
h3 { font-size: var(--font-size-xl); }
h4 { font-size: var(--font-size-lg); }
h5 { font-size: var(--font-size-base); }
h6 { font-size: var(--font-size-sm); }

p {
    margin-bottom: var(--space-md);
    color: var(--color-text-secondary);
}

a {
    color: var(--color-primary);
    text-decoration: none;
    transition: color var(--transition-fast);
}

a:hover {
    color: var(--color-primary-dark);
    text-decoration: underline;
}

code, pre {
    font-family: var(--font-family-mono);
    font-size: var(--font-size-sm);
}

/* ============================================================================
   4. TOP NAVIGATION BAR
   ============================================================================ */
.dashboard-header {
    position: sticky;
    top: 0;
    z-index: var(--z-sticky);
    background: var(--color-background);
    border-bottom: 1px solid var(--color-border);
    box-shadow: var(--shadow-sm);
}

.header-container {
    max-width: 1920px;
    margin: 0 auto;
    padding: 0 var(--space-xl);
}

.header-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 64px;
}

.header-brand {
    display: flex;
    align-items: center;
    gap: var(--space-md);
}

.brand-logo {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-light));
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-text-inverse);
    font-size: var(--font-size-xl);
}

.brand-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text-primary);
    margin: 0;
}

.brand-subtitle {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    font-weight: var(--font-weight-normal);
    display: block;
    margin-top: -4px;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: var(--space-md);
}

.search-box {
    position: relative;
    width: 320px;
}

.search-input {
    width: 100%;
    height: 40px;
    padding: 0 var(--space-md) 0 var(--space-2xl);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-full);
    font-size: var(--font-size-sm);
    transition: all var(--transition-base);
    background: var(--color-surface);
}

.search-input:focus {
    outline: none;
    border-color: var(--color-primary);
    background: var(--color-background);
    box-shadow: 0 0 0 3px rgba(0, 85, 164, 0.1);
}

.search-icon {
    position: absolute;
    left: var(--space-md);
    top: 50%;
    transform: translateY(-50%);
    color: var(--color-text-muted);
    pointer-events: none;
}

.header-button {
    height: 40px;
    padding: 0 var(--space-lg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-background);
    color: var(--color-text-primary);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all var(--transition-base);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.header-button:hover {
    background: var(--color-surface);
    border-color: var(--color-primary);
}

.header-button.primary {
    background: var(--color-primary);
    border-color: var(--color-primary);
    color: var(--color-text-inverse);
}

.header-button.primary:hover {
    background: var(--color-primary-dark);
    border-color: var(--color-primary-dark);
}

.header-nav {
    border-top: 1px solid var(--color-border-light);
}

.nav-menu {
    display: flex;
    list-style: none;
    gap: var(--space-xs);
    padding: 0;
    margin: 0;
}

.nav-item {
    position: relative;
}

.nav-link {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-md) var(--space-lg);
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    text-decoration: none;
    transition: all var(--transition-base);
    border-bottom: 2px solid transparent;
}

.nav-link:hover {
    color: var(--color-primary);
    background: var(--color-surface);
    text-decoration: none;
}

.nav-link.active {
    color: var(--color-primary);
    border-bottom-color: var(--color-primary);
}

.nav-icon {
    font-size: var(--font-size-base);
}

/* Breadcrumb */
.breadcrumb {
    padding: var(--space-md) var(--space-xl);
    background: var(--color-surface);
    border-bottom: 1px solid var(--color-border-light);
}

.breadcrumb-list {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: var(--font-size-sm);
}

.breadcrumb-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    color: var(--color-text-muted);
}

.breadcrumb-item:not(:last-child)::after {
    content: '/';
    color: var(--color-text-muted);
}

.breadcrumb-link {
    color: var(--color-text-secondary);
    transition: color var(--transition-fast);
}

.breadcrumb-link:hover {
    color: var(--color-primary);
    text-decoration: none;
}

.breadcrumb-item:last-child {
    color: var(--color-text-primary);
    font-weight: var(--font-weight-medium);
}

/* ============================================================================
   5. MAIN LAYOUT
   ============================================================================ */
.dashboard-container {
    max-width: 1920px;
    margin: 0 auto;
    padding: var(--space-xl);
}

.dashboard-grid {
    display: grid;
    gap: var(--space-xl);
}

/* ============================================================================
   6. CARD COMPONENTS
   ============================================================================ */
.card {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    overflow: hidden;
    transition: box-shadow var(--transition-base);
}

.card:hover {
    box-shadow: var(--shadow-md);
}

.card-header {
    padding: var(--space-lg) var(--space-xl);
    border-bottom: 1px solid var(--color-border-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.card-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0;
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.card-title-icon {
    color: var(--color-primary);
}

.card-actions {
    display: flex;
    gap: var(--space-sm);
}

.card-action-button {
    padding: var(--space-sm) var(--space-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: transparent;
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.card-action-button:hover {
    background: var(--color-surface);
    color: var(--color-primary);
    border-color: var(--color-primary);
}

.card-body {
    padding: var(--space-xl);
}

.card-footer {
    padding: var(--space-md) var(--space-xl);
    border-top: 1px solid var(--color-border-light);
    background: var(--color-surface);
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

/* ============================================================================
   7. KPI TILES
   ============================================================================ */
.kpi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: var(--space-lg);
    margin-bottom: var(--space-xl);
}

.kpi-card {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-xl);
    box-shadow: var(--shadow-sm);
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
}

.kpi-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--kpi-color, var(--color-primary));
}

.kpi-card:hover {
    box-shadow: var(--shadow-lg);
    transform: translateY(-2px);
}

.kpi-card.success {
    --kpi-color: var(--color-success);
}

.kpi-card.warning {
    --kpi-color: var(--color-warning);
}

.kpi-card.critical {
    --kpi-color: var(--color-critical);
}

.kpi-card.info {
    --kpi-color: var(--color-info);
}

.kpi-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: var(--space-lg);
}

.kpi-icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--font-size-2xl);
    background: var(--kpi-bg, var(--color-info-light));
    color: var(--kpi-color, var(--color-primary));
}

.kpi-card.success .kpi-icon {
    --kpi-bg: var(--color-success-light);
}

.kpi-card.warning .kpi-icon {
    --kpi-bg: var(--color-warning-light);
}

.kpi-card.critical .kpi-icon {
    --kpi-bg: var(--color-critical-light);
}

.kpi-badge {
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    background: var(--kpi-bg);
    color: var(--kpi-color);
}

.kpi-value {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text-primary);
    line-height: 1;
    margin-bottom: var(--space-sm);
}

.kpi-label {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-md);
}

.kpi-trend {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
}

.kpi-trend.up {
    color: var(--color-success);
}

.kpi-trend.down {
    color: var(--color-critical);
}

/* ============================================================================
   8. STATUS BADGES
   ============================================================================ */
.status-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-xs) var(--space-md);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-badge.healthy {
    background: var(--color-success-light);
    color: var(--color-success);
}

.status-badge.warning {
    background: var(--color-warning-light);
    color: #D68910;
}

.status-badge.critical {
    background: var(--color-critical-light);
    color: var(--color-critical);
}

.status-badge.unknown {
    background: #F0F3F7;
    color: var(--color-text-muted);
}

.status-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: currentColor;
}

/* ============================================================================
   9. DATA TABLES
   ============================================================================ */
.data-table-container {
    overflow-x: auto;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--font-size-sm);
}

.data-table thead {
    background: var(--color-surface);
    border-bottom: 2px solid var(--color-border);
}

.data-table th {
    padding: var(--space-md) var(--space-lg);
    text-align: left;
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    white-space: nowrap;
}

.data-table tbody tr {
    border-bottom: 1px solid var(--color-border-light);
    transition: background var(--transition-fast);
}

.data-table tbody tr:hover {
    background: var(--color-surface);
}

.data-table td {
    padding: var(--space-md) var(--space-lg);
    color: var(--color-text-secondary);
}

.data-table td code {
    padding: var(--space-xs) var(--space-sm);
    background: var(--color-surface);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
}

/* ============================================================================
   10. WIDGETS & PANELS
   ============================================================================ */
.widget-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: var(--space-xl);
}

.widget {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    overflow: hidden;
}

.widget-header {
    padding: var(--space-lg) var(--space-xl);
    border-bottom: 1px solid var(--color-border-light);
    background: var(--color-surface);
}

.widget-title {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0;
}

.widget-body {
    padding: var(--space-xl);
}

/* ============================================================================
   11. CHARTS & VISUALIZATIONS
   ============================================================================ */
.chart-container {
    position: relative;
    width: 100%;
    min-height: 300px;
}

.chart-loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-md);
}

.chart-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid var(--color-border);
    border-top-color: var(--color-primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* ============================================================================
   12. BUTTONS
   ============================================================================ */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-lg);
    border: 1px solid transparent;
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    font-family: var(--font-family);
    line-height: 1.5;
    cursor: pointer;
    transition: all var(--transition-base);
    text-decoration: none;
    white-space: nowrap;
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.btn-primary {
    background: var(--color-primary);
    color: var(--color-text-inverse);
}

.btn-primary:hover:not(:disabled) {
    background: var(--color-primary-dark);
}

.btn-secondary {
    background: var(--color-surface);
    border-color: var(--color-border);
    color: var(--color-text-primary);
}

.btn-secondary:hover:not(:disabled) {
    background: var(--color-border-light);
    border-color: var(--color-primary);
}

.btn-success {
    background: var(--color-success);
    color: var(--color-text-inverse);
}

.btn-success:hover:not(:disabled) {
    background: #009B7D;
}

.btn-warning {
    background: var(--color-warning);
    color: var(--color-text-primary);
}

.btn-critical {
    background: var(--color-critical);
    color: var(--color-text-inverse);
}

.btn-sm {
    padding: var(--space-xs) var(--space-md);
    font-size: var(--font-size-xs);
}

.btn-lg {
    padding: var(--space-md) var(--space-xl);
    font-size: var(--font-size-base);
}

/* ============================================================================
   13. FILTERS & CONTROLS
   ============================================================================ */
.filter-bar {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-lg);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-xl);
    flex-wrap: wrap;
}

.filter-group {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.filter-label {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text-secondary);
}

.filter-select {
    padding: var(--space-sm) var(--space-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-sm);
    background: var(--color-background);
    color: var(--color-text-primary);
    cursor: pointer;
    transition: all var(--transition-base);
}

.filter-select:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(0, 85, 164, 0.1);
}

/* ============================================================================
   14. RESPONSIVE DESIGN
   ============================================================================ */
@media (max-width: 1200px) {
    .dashboard-container {
        padding: var(--space-lg);
    }
    
    .kpi-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    
    .widget-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .header-container {
        padding: 0 var(--space-md);
    }
    
    .header-top {
        height: 56px;
    }
    
    .brand-title {
        font-size: var(--font-size-lg);
    }
    
    .search-box {
        width: 200px;
    }
    
    .nav-menu {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    .nav-link {
        padding: var(--space-sm) var(--space-md);
    }
    
    .dashboard-container {
        padding: var(--space-md);
    }
    
    .kpi-grid {
        grid-template-columns: 1fr;
    }
    
    .kpi-value {
        font-size: var(--font-size-3xl);
    }
    
    .card-header,
    .card-body {
        padding: var(--space-md);
    }
    
    .filter-bar {
        flex-direction: column;
        align-items: stretch;
    }
}

@media (max-width: 480px) {
    .header-actions {
        gap: var(--space-sm);
    }
    
    .search-box {
        display: none;
    }
    
    .header-button {
        padding: 0 var(--space-md);
    }
    
    .breadcrumb {
        padding: var(--space-sm) var(--space-md);
    }
    
    .kpi-card {
        padding: var(--space-md);
    }
    
    .kpi-icon {
        width: 40px;
        height: 40px;
        font-size: var(--font-size-xl);
    }
    
    .kpi-value {
        font-size: var(--font-size-2xl);
    }
}

/* ============================================================================
   15. UTILITY CLASSES
   ============================================================================ */
.text-center { text-align: center; }
.text-right { text-align: right; }
.text-muted { color: var(--color-text-muted); }
.text-primary { color: var(--color-primary); }
.text-success { color: var(--color-success); }
.text-warning { color: var(--color-warning); }
.text-critical { color: var(--color-critical); }

.mb-0 { margin-bottom: 0; }
.mb-sm { margin-bottom: var(--space-sm); }
.mb-md { margin-bottom: var(--space-md); }
.mb-lg { margin-bottom: var(--space-lg); }
.mb-xl { margin-bottom: var(--space-xl); }

.mt-0 { margin-top: 0; }
.mt-sm { margin-top: var(--space-sm); }
.mt-md { margin-top: var(--space-md); }
.mt-lg { margin-top: var(--space-lg); }
.mt-xl { margin-top: var(--space-xl); }

.d-flex { display: flex; }
.d-grid { display: grid; }
.d-none { display: none; }
.d-block { display: block; }

.align-center { align-items: center; }
.justify-between { justify-content: space-between; }
.gap-sm { gap: var(--space-sm); }
.gap-md { gap: var(--space-md); }
.gap-lg { gap: var(--space-lg); }

/* ============================================================================
   16. TCP CONNECTION ANALYSIS STYLES
   ============================================================================ */

/* TCP Status Badges */
.tcp-status-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
    font-weight: 600;
    white-space: nowrap;
}

.tcp-status-success {
    background-color: #d4edda;
    color: #155724;
}

.tcp-status-failed {
    background-color: #f8d7da;
    color: #721c24;
}

.tcp-status-partial {
    background-color: #fff3cd;
    color: #856404;
}

/* Row highlighting based on status */
.status-row-success {
    background-color: rgba(0, 184, 148, 0.05);
}

.status-row-success:hover {
    background-color: rgba(0, 184, 148, 0.1);
}

.status-row-failed {
    background-color: rgba(225, 112, 85, 0.08);
}

.status-row-failed:hover {
    background-color: rgba(225, 112, 85, 0.15);
}

.status-row-partial {
    background-color: rgba(253, 203, 110, 0.08);
}

.status-row-partial:hover {
    background-color: rgba(253, 203, 110, 0.15);
}

/* Copy Filter Button */
.copy-filter-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    padding: 0;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: var(--color-background);
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
}

.copy-filter-btn:hover {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
}

.copy-filter-btn:active {
    transform: scale(0.95);
}

/* Wireshark Filter Code */
.wireshark-filter {
    background: var(--color-surface);
    padding: 4px 8px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--color-border);
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
    white-space: nowrap;
}

/* ============================================================================
   17. PRINT STYLES
   ============================================================================ */
@media print {
    .dashboard-header,
    .breadcrumb,
    .filter-bar,
    .card-actions,
    .header-button {
        display: none;
    }
    
    .card {
        break-inside: avoid;
        box-shadow: none;
        border: 1px solid #ddd;
    }
    
    body {
        background: white;
    }
}
</style>
</head>
<body>
    
    <header class="dashboard-header">
        <div class="header-container">
            
            <div class="header-top">
                
                <div class="header-brand">
                    <div class="brand-logo">
                        <i class="fas fa-network-wired"></i>
                    </div>
                    <div>
                        <h1 class="brand-title">
                            SD-WAN Network Triage
                            <span class="brand-subtitle">v2.7.0 - Enterprise Dashboard</span>
                        </h1>
                    </div>
                </div>
                
                
                <div class="header-actions">
                    
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" id="globalSearch" placeholder="Search IPs, devices, events...">
                    </div>
                    
                    
                    <button class="header-button" onclick="window.print()">
                        <i class="fas fa-download"></i>
                        <span>Export PDF</span>
                    </button>
                    
                    
                    <button class="header-button primary" onclick="location.reload()">
                        <i class="fas fa-sync-alt"></i>
                        <span>Refresh</span>
                    </button>
                </div>
            </div>
            
            
            <nav class="header-nav">
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#dashboard" class="nav-link active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt nav-icon"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#security" class="nav-link" data-section="security">
                            <i class="fas fa-shield-alt nav-icon"></i>
                            <span>Security</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#performance" class="nav-link" data-section="performance">
                            <i class="fas fa-chart-line nav-icon"></i>
                            <span>Performance</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#traffic" class="nav-link" data-section="traffic">
                            <i class="fas fa-exchange-alt nav-icon"></i>
                            <span>Traffic</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#protocols" class="nav-link" data-section="protocols">
                            <i class="fas fa-layer-group nav-icon"></i>
                            <span>Protocols</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#tunnels" class="nav-link" data-section="tunnels">
                            <i class="fas fa-network-wired nav-icon"></i>
                            <span>Tunnels & SD-WAN</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#visualizations" class="nav-link" data-section="visualizations">
                            <i class="fas fa-project-diagram nav-icon"></i>
                            <span>Visualizations</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#devices" class="nav-link" data-section="devices">
                            <i class="fas fa-laptop nav-icon"></i>
                            <span>Devices</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    
    
    <div class="breadcrumb">
        <ul class="breadcrumb-list">
            <li class="breadcrumb-item">
                <a href="#" class="breadcrumb-link">Home</a>
            </li>
            <li class="breadcrumb-item" id="currentSection">Dashboard</li>
        </ul>
    </div>
    
    
    <main class="dashboard-container">
        
        
        <section id="dashboard" class="dashboard-section">
            <div class="kpi-grid">
                
                <div class="kpi-card warning">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <span class="kpi-badge">
                            Warning
                        </span>
                    </div>
                    <div class="kpi-value">Warning</div>
                    <div class="kpi-label">Network Health Status</div>
                    <div class="kpi-trend">
                        <i class="fas fa-info-circle"></i>
                        <span>Based on 4 findings</span>
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-handshake-slash"></i>
                        </div>
                        
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">Failed TCP Handshakes</div>
                    <div class="kpi-trend ">
                        
                        <i class="fas fa-check-circle"></i>
                        <span>All connections successful</span>
                        
                    </div>
                </div>
                
                
                <div class="kpi-card critical">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        
                        <span class="kpi-badge">!</span>
                        
                    </div>
                    <div class="kpi-value">2</div>
                    <div class="kpi-label">Security Threats</div>
                    <div class="kpi-trend">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>DDoS: 2 | Scans: 0 | IOCs: 0 | BGP: 0</span>
                    </div>
                </div>
                
                
                <div class="kpi-card info">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">TCP Retransmissions</div>
                    <div class="kpi-trend">
                        <i class="fas fa-clock"></i>
                        <span>High RTT: 0 | HTTP Errors: 0</span>
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-network-wired"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">Tunnels Detected</div>
                    <div class="kpi-trend">
                        <i class="fas fa-info-circle"></i>
                        <span>VXLAN, GRE, IPsec, etc.</span>
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-sitemap"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">SD-WAN Vendors</div>
                    <div class="kpi-trend">
                        <i class="fas fa-fingerprint"></i>
                        <span>Detected vendor signatures</span>
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-phone-volume"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">VoIP Calls</div>
                    <div class="kpi-trend">
                        <i class="fas fa-info-circle"></i>
                        <span>SIP/RTP sessions detected</span>
                    </div>
                </div>
                
                
                <div class="kpi-card info">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-globe"></i>
                        </div>
                    </div>
                    <div class="kpi-value">2</div>
                    <div class="kpi-label">DNS Queries</div>
                    <div class="kpi-trend ">
                        
                        <i class="fas fa-check-circle"></i>
                        <span>No anomalies detected</span>
                        
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-laptop"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">Devices Identified</div>
                    <div class="kpi-trend">
                        <i class="fas fa-fingerprint"></i>
                        <span>ARP Conflicts: 0</span>
                    </div>
                </div>
            </div>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-clipboard-list card-title-icon"></i>
                        Executive Summary
                    </h2>
                    <div class="card-actions">
                        <button class="card-action-button" onclick="toggleSection('executive-summary')">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body" id="executive-summary">
                    <div class="dashboard-grid" style="grid-template-columns: 2fr 1fr; gap: var(--space-xl);">
                        
                        <div>
                            <h3 class="mb-md">Analysis Overview</h3>
                            <p class="text-muted mb-lg">
                                Analyzed <strong>TestFile4.pcap</strong> containing <strong>0 packets</strong> 
                                on <strong>2026-01-14 20:26:33</strong>.
                            </p>
                            
                            
                            <div class="mb-lg">
                                <div class="executive-summary-explanation">
		<p class="info-box">
			<i class="fas fa-info-circle"></i>
			<strong>About this Summary:</strong> This executive summary provides a high-level overview of your network's health based on analysis of the captured traffic. 
			The <strong>Risk Level</strong> indicates the overall severity of findings detected (Low, Medium, High, or Critical), calculated from the number and type of security issues, performance problems, and anomalies found. 
			The counters below highlight the most significant categories of issues that require attention. Use this summary to quickly assess network health and prioritize troubleshooting efforts.
		</p>
	</div>
                            </div>
                            
                            
                            
                            <h4 class="mb-md">Key Findings</h4>
                            <div class="d-grid gap-md mb-lg">
                                
                                <div class="status-badge critical">
                                    <span class="status-dot"></span>
                                    <span>2 DDoS Attack(s) Detected</span>
                                </div>
                                
                                
                                
                                
                                
                                
                                
                                
                                
                            </div>
                        </div>
                        
                        
                        <div>
                            <div class="card" style="background: var(--color-surface); border: none;">
                                <div class="card-body">
                                    <h4 class="mb-md">Risk Assessment</h4>
                                    <div class="text-center mb-lg">
                                        <div class="kpi-value" style="font-size: var(--font-size-4xl); color: var(--color-warning);">
                                            20
                                        </div>
                                        <div class="kpi-label">Risk Score</div>
                                        <span class="status-badge warning">
                                            <span class="status-dot"></span>
                                            Medium Risk
                                        </span>
                                    </div>
                                    
                                    
                                    <h5 class="mb-sm">Recommended Actions</h5>
                                    <ul style="padding-left: var(--space-lg); margin: 0; font-size: var(--font-size-sm); color: var(--color-text-secondary);">
                                        
                                        <li style="margin-bottom: var(--space-sm);">CRITICAL: Potential DDoS attack detected. Enable rate limiting and contact your ISP if needed.</li>
                                        
                                    </ul>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <i class="fas fa-clock"></i> Last updated: 2026-01-14 20:26:33
                </div>
            </div>
        </section>
        
        
        <section id="security" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-shield-alt" style="color: var(--color-primary);"></i>
                Security Analysis
            </h2>
            
            
            <div class="widget-grid mb-xl">
                
                
                <div class="widget" style="grid-column: 1 / -1;">
                    <div class="widget-header" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); color: white; padding: 20px 24px;">
                        <h3 class="widget-title" style="color: white; margin: 0; font-size: 1.25rem;">
                            <i class="fas fa-bomb" style="margin-right: 12px;"></i>
                            DDoS Attacks Detected (2)
                        </h3>
                        <p style="margin: 8px 0 0 0; font-size: 0.875rem; opacity: 0.9;">
                            <i class="fas fa-exclamation-circle"></i> Critical security threat requiring immediate attention
                        </p>
                    </div>
                    
                    
                    <div style="background: #fef2f2; border-left: 4px solid #dc2626; padding: 16px 24px; margin: 0;">
                        <h4 style="margin: 0 0 8px 0; color: #991b1b; font-size: 0.95rem;">
                            <i class="fas fa-graduation-cap"></i> What is a DDoS Attack?
                        </h4>
                        <p style="margin: 0; color: #7f1d1d; font-size: 0.85rem; line-height: 1.6;">
                            A <strong>Distributed Denial of Service (DDoS)</strong> attack floods your network with malicious traffic to overwhelm servers and disrupt legitimate services. 
                            Common types include <strong>SYN floods</strong> (TCP connection exhaustion), <strong>UDP floods</strong> (bandwidth saturation), and <strong>ICMP floods</strong> (ping storms).
                        </p>
                    </div>
                    
                    <div class="widget-body" style="padding: 24px;">
                        
                        
                        <div class="data-table-container" style="margin-bottom: 20px;">
                            <table class="data-table" style="width: 100%;">
                                <thead>
                                    <tr style="background: #fef2f2;">
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #991b1b;">Attack Type</th>
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #991b1b;">Source IP</th>
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #991b1b;">Target IP</th>
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #991b1b;">Packets</th>
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #991b1b;">Severity</th>
                                        <th style="padding: 12px 16px; text-align: left; font-weight: 600; color: #991b1b;">Impact</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    
                                    <tr style="border-bottom: 1px solid #fecaca;">
                                        <td style="padding: 14px 16px;">
                                            <span style="display: inline-flex; align-items: center; gap: 8px;">
                                                
                                                <span style="background: #ca8a04; color: white; padding: 4px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">ICMP FLOOD</span>
                                                
                                            </span>
                                        </td>
                                        <td style="padding: 14px 16px;"><code style="background: #fee2e2; padding: 4px 8px; border-radius: 4px; color: #991b1b;">10.11.1.241</code></td>
                                        <td style="padding: 14px 16px;"><code style="background: #fef3c7; padding: 4px 8px; border-radius: 4px; color: #92400e;">8.8.8.8</code></td>
                                        <td style="padding: 14px 16px; font-weight: 600; color: #dc2626;">100</td>
                                        <td style="padding: 14px 16px;">
                                            
                                            <span style="background: #ca8a04; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">
                                                <i class="fas fa-exclamation-circle"></i> MODERATE
                                            </span>
                                            
                                        </td>
                                        <td style="padding: 14px 16px; font-size: 0.85rem; color: #6b7280;">
                                            Network congestion
                                            
                                        </td>
                                    </tr>
                                    
                                    <tr style="border-bottom: 1px solid #fecaca;">
                                        <td style="padding: 14px 16px;">
                                            <span style="display: inline-flex; align-items: center; gap: 8px;">
                                                
                                                <span style="background: #ea580c; color: white; padding: 4px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">UDP FLOOD</span>
                                                
                                            </span>
                                        </td>
                                        <td style="padding: 14px 16px;"><code style="background: #fee2e2; padding: 4px 8px; border-radius: 4px; color: #991b1b;">10.11.1.241</code></td>
                                        <td style="padding: 14px 16px;"><code style="background: #fef3c7; padding: 4px 8px; border-radius: 4px; color: #92400e;">10.199.1.118</code></td>
                                        <td style="padding: 14px 16px; font-weight: 600; color: #dc2626;">200</td>
                                        <td style="padding: 14px 16px;">
                                            
                                            <span style="background: #ca8a04; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">
                                                <i class="fas fa-exclamation-circle"></i> MODERATE
                                            </span>
                                            
                                        </td>
                                        <td style="padding: 14px 16px; font-size: 0.85rem; color: #6b7280;">
                                            Bandwidth saturation
                                            
                                        </td>
                                    </tr>
                                    
                                </tbody>
                            </table>
                        </div>
                        
                        
                        <div style="background: #f0fdf4; border: 1px solid #86efac; border-radius: 8px; padding: 20px;">
                            <h4 style="margin: 0 0 12px 0; color: #166534; font-size: 1rem;">
                                <i class="fas fa-tasks"></i> Recommended Actions for Junior Engineers
                            </h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 12px;">
                                <div style="background: white; border-radius: 6px; padding: 12px 16px; border-left: 3px solid #22c55e;">
                                    <strong style="color: #166534; font-size: 0.85rem;">1. Identify & Block Source</strong>
                                    <p style="margin: 6px 0 0 0; font-size: 0.8rem; color: #4b5563;">
                                        Add firewall rule to block attacking IP ranges. Use: <code style="background: #e5e7eb; padding: 2px 6px; border-radius: 3px;">iptables -A INPUT -s [SOURCE_IP] -j DROP</code>
                                    </p>
                                </div>
                                <div style="background: white; border-radius: 6px; padding: 12px 16px; border-left: 3px solid #22c55e;">
                                    <strong style="color: #166534; font-size: 0.85rem;">2. Enable Rate Limiting</strong>
                                    <p style="margin: 6px 0 0 0; font-size: 0.8rem; color: #4b5563;">
                                        Configure rate limiting on affected ports to prevent connection exhaustion. Check SD-WAN QoS policies.
                                    </p>
                                </div>
                                <div style="background: white; border-radius: 6px; padding: 12px 16px; border-left: 3px solid #22c55e;">
                                    <strong style="color: #166534; font-size: 0.85rem;">3. Verify Target Services</strong>
                                    <p style="margin: 6px 0 0 0; font-size: 0.8rem; color: #4b5563;">
                                        Confirm if targeted IPs host critical services. Prioritize protection for business-critical systems.
                                    </p>
                                </div>
                                <div style="background: white; border-radius: 6px; padding: 12px 16px; border-left: 3px solid #22c55e;">
                                    <strong style="color: #166534; font-size: 0.85rem;">4. Escalate if Persistent</strong>
                                    <p style="margin: 6px 0 0 0; font-size: 0.8rem; color: #4b5563;">
                                        If attack continues, escalate to security team and consider enabling upstream DDoS protection.
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                
                
                
                
                
                
                
                
                
                
                
                
            </div>
            
            
            
            
            
            
        </section>
        
        
        <section id="performance" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-chart-line" style="color: var(--color-primary);"></i>
                Performance Analysis
            </h2>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-handshake card-title-icon"></i>
                        TCP Connection Analysis - Per-Flow Breakdown
                    </h3>
                    <div class="card-actions">
                        <span class="status-badge healthy">
                            <span class="status-dot"></span>
                            0 Success / 0 Failed
                        </span>
                    </div>
                </div>
                <div class="card-body">
                    
                    <div class="dashboard-grid" style="grid-template-columns: repeat(4, 1fr); gap: var(--space-md); margin-bottom: var(--space-xl);">
                        <div style="text-align: center; padding: var(--space-md); background: var(--color-surface); border-radius: var(--radius-md); border-left: 4px solid var(--color-info);">
                            <div style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-info);">0</div>
                            <div style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Total SYN</div>
                        </div>
                        <div style="text-align: center; padding: var(--space-md); background: var(--color-surface); border-radius: var(--radius-md); border-left: 4px solid var(--color-success);">
                            <div style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-success);">0</div>
                            <div style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Total SYN-ACK</div>
                        </div>
                        <div style="text-align: center; padding: var(--space-md); background: var(--color-surface); border-radius: var(--radius-md); border-left: 4px solid var(--color-success);">
                            <div style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-success);">0</div>
                            <div style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Successful</div>
                        </div>
                        <div style="text-align: center; padding: var(--space-md); background: var(--color-surface); border-radius: var(--radius-md); border-left: 4px solid var(--color-success);">
                            <div style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-success);">0</div>
                            <div style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Failed</div>
                        </div>
                    </div>
                    
                    
                    <div style="background: rgba(0, 184, 148, 0.1); border-left: 4px solid var(--color-success); padding: var(--space-lg); border-radius: var(--radius-md);">
                        <h4 style="margin: 0 0 var(--space-sm) 0; color: var(--color-success);">
                            <i class="fas fa-check-circle"></i> All Connections Successful
                        </h4>
                        <p style="margin: 0; color: var(--color-text-secondary); font-size: var(--font-size-sm);">
                            All TCP connection attempts successfully completed the three-way handshake. No unreachable services detected.
                        </p>
                    </div>
                    
                </div>
            </div>
            
            
            
            
            
            
            
            <div class="widget-grid mb-xl">
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-redo" style="color: var(--color-warning);"></i>
                            TCP Retransmissions
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl); margin-bottom: var(--space-md);">
                            0
                        </div>
                        <p class="text-muted mb-md">Total retransmission events detected</p>
                        
                        <div class="status-badge healthy">
                            <span class="status-dot"></span>
                            Normal retransmission rate
                        </div>
                        
                    </div>
                </div>
                
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-clock" style="color: var(--color-info);"></i>
                            High Latency Flows
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl); margin-bottom: var(--space-md);">
                            0
                        </div>
                        <p class="text-muted mb-md">Flows with elevated round-trip time</p>
                        
                        <div class="status-badge healthy">
                            <span class="status-dot"></span>
                            Latency within acceptable range
                        </div>
                        
                    </div>
                </div>
            </div>
            
            
            
            
            
            
        </section>
        
        
        <section id="traffic" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-exchange-alt" style="color: var(--color-primary);"></i>
                Traffic Analysis
            </h2>
            
            
            <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; margin-bottom: 24px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                
                <div style="background: linear-gradient(135deg, #f97316 0%, #fb923c 100%); color: white; padding: 20px 24px;">
                    <h3 style="margin: 0 0 8px 0; font-size: 1.25rem; font-weight: 600; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-chart-bar"></i>
                        Top Traffic Flow Analysis
                        <span style="background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 0.875rem; font-weight: 500;">5 flows</span>
                    </h3>
                    <p style="margin: 0; opacity: 0.9; font-size: 0.875rem;">Identify bandwidth consumers and traffic patterns</p>
                </div>
                
                
                <div style="background: #fff7ed; border-bottom: 1px solid #fed7aa; padding: 20px 24px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px;">
                        <div style="background: #ea580c; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div>
                            <h4 style="margin: 0 0 8px 0; color: #c2410c; font-size: 1rem;">Understanding Traffic Flows</h4>
                            <p style="margin: 0 0 12px 0; color: #ea580c; font-size: 0.875rem; line-height: 1.6;">
                                Traffic flows show which connections consume the most bandwidth. High-volume flows may indicate 
                                <strong>large file transfers</strong>, <strong>video streaming</strong>, <strong>backups</strong>, or potentially 
                                <strong>unauthorized data exfiltration</strong>. Monitoring top consumers helps optimize network performance.
                            </p>
                            <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap; font-size: 0.8125rem;">
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #22c55e; border-radius: 50%;"></span>
                                    <span style="color: #166534;">0-5% = Normal usage</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #f59e0b; border-radius: 50%;"></span>
                                    <span style="color: #92400e;">5-15% = High usage</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #ef4444; border-radius: 50%;"></span>
                                    <span style="color: #dc2626;">&gt;15% = Bandwidth hog</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <div style="padding: 16px 24px;">
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #fecaca; border-radius: 8px; overflow: hidden; background: #fef2f2;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-exchange-alt" style="color: #ef4444;"></i>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    10.11.1.241:161
                                </span>
                                <span style="color: #9ca3af; font-weight: bold;"></span>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    10.199.1.118:62494
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="background: #fecaca; color: #dc2626; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                                    77.0%
                                </span>
                                <span style="background: #e0e7ff; color: #3730a3; padding: 4px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">
                                    TCP
                                </span>
                                <span style="color: #6b7280; font-size: 0.8125rem; font-weight: 500;">
                                    69.1 KB
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                    <span style="font-weight: 600; color: #374151; font-size: 0.875rem;">Bandwidth Usage:</span>
                                    <div style="flex: 1; height: 12px; background: #e5e7eb; border-radius: 6px; overflow: hidden;">
                                        <div style="width: 77.0%; height: 100%; background: #ef4444; border-radius: 6px;"></div>
                                    </div>
                                    <span style="font-size: 0.875rem; color: #374151; font-weight: 600; min-width: 60px;">77.0%</span>
                                </div>
                            </div>
                            
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Source</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">10.11.1.241:161</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Destination</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">10.199.1.118:62494</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Protocol</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">TCP</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Data Transferred</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">69.1 KB</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #dc2626; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-exclamation-circle"></i>
                                    High Bandwidth Consumer
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #991b1b; line-height: 1.6;">
                                    This flow is consuming a significant portion of available bandwidth. This could indicate large file transfers, video streaming, backup operations, or potentially unauthorized data movement. Immediate investigation recommended.
                                    
                                </p>
                            </div>
                            
                            
                            <div style="background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #1e40af; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-tasks"></i>
                                    Next Actions
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #1e3a8a; line-height: 1.8;">
                                    
                                    <li><strong>Identify Application:</strong> Determine what application is generating this traffic</li>
                                    <li><strong>Verify Legitimacy:</strong> Confirm this is authorized business traffic</li>
                                    <li><strong>Check QoS:</strong> Review QoS policies for this traffic class</li>
                                    <li><strong>Contact User:</strong> If source is a workstation, verify user activity</li>
                                    
                                </ul>
                            </div>
                            
                            
                            <div style="background: #faf5ff; border: 1px solid #e9d5ff; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #7c3aed; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-filter"></i>
                                    Wireshark Filter
                                </h4>
                                <code style="display: block; padding: 10px 12px; background: #ffffff; border: 1px solid #ddd6fe; border-radius: 6px; font-size: 0.75rem; word-break: break-all; font-family: 'Courier New', monospace; color: #5b21b6;">ip.addr==10.11.1.241 && ip.addr==10.199.1.118</code>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #fde68a; border-radius: 8px; overflow: hidden; background: #fefce8;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-exchange-alt" style="color: #f59e0b;"></i>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    10.11.1.241:46101
                                </span>
                                <span style="color: #9ca3af; font-weight: bold;"></span>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    158.115.136.228:7351
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="background: #fde68a; color: #92400e; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                                    9.6%
                                </span>
                                <span style="background: #e0e7ff; color: #3730a3; padding: 4px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">
                                    TCP
                                </span>
                                <span style="color: #6b7280; font-size: 0.8125rem; font-weight: 500;">
                                    8.6 KB
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                    <span style="font-weight: 600; color: #374151; font-size: 0.875rem;">Bandwidth Usage:</span>
                                    <div style="flex: 1; height: 12px; background: #e5e7eb; border-radius: 6px; overflow: hidden;">
                                        <div style="width: 9.6%; height: 100%; background: #f59e0b; border-radius: 6px;"></div>
                                    </div>
                                    <span style="font-size: 0.875rem; color: #374151; font-weight: 600; min-width: 60px;">9.6%</span>
                                </div>
                            </div>
                            
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Source</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">10.11.1.241:46101</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Destination</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">158.115.136.228:7351</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Protocol</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">TCP</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Data Transferred</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">8.6 KB</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #fefce8; border: 1px solid #fde68a; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #92400e; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Elevated Traffic
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #78350f; line-height: 1.6;">
                                    This flow shows elevated traffic levels. While not critical, it's worth monitoring to ensure it's legitimate business traffic and not impacting other users.
                                    
                                </p>
                            </div>
                            
                            
                            <div style="background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #1e40af; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-tasks"></i>
                                    Next Actions
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #1e3a8a; line-height: 1.8;">
                                    
                                    <li><strong>Monitor Trend:</strong> Watch if this flow continues to grow</li>
                                    <li><strong>Identify Application:</strong> Determine the application type</li>
                                    <li><strong>Review Policies:</strong> Ensure traffic aligns with acceptable use policy</li>
                                    
                                </ul>
                            </div>
                            
                            
                            <div style="background: #faf5ff; border: 1px solid #e9d5ff; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #7c3aed; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-filter"></i>
                                    Wireshark Filter
                                </h4>
                                <code style="display: block; padding: 10px 12px; background: #ffffff; border: 1px solid #ddd6fe; border-radius: 6px; font-size: 0.75rem; word-break: break-all; font-family: 'Courier New', monospace; color: #5b21b6;">ip.addr==10.11.1.241 && ip.addr==158.115.136.228</code>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #bbf7d0; border-radius: 8px; overflow: hidden; background: #f0fdf4;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-exchange-alt" style="color: #22c55e;"></i>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    10.11.1.241:40578
                                </span>
                                <span style="color: #9ca3af; font-weight: bold;"></span>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    158.115.141.254:7351
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="background: #d1fae5; color: #047857; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                                    0.8%
                                </span>
                                <span style="background: #e0e7ff; color: #3730a3; padding: 4px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">
                                    TCP
                                </span>
                                <span style="color: #6b7280; font-size: 0.8125rem; font-weight: 500;">
                                    700 B
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                    <span style="font-weight: 600; color: #374151; font-size: 0.875rem;">Bandwidth Usage:</span>
                                    <div style="flex: 1; height: 12px; background: #e5e7eb; border-radius: 6px; overflow: hidden;">
                                        <div style="width: 0.8%; height: 100%; background: #22c55e; border-radius: 6px;"></div>
                                    </div>
                                    <span style="font-size: 0.875rem; color: #374151; font-weight: 600; min-width: 60px;">0.8%</span>
                                </div>
                            </div>
                            
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Source</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">10.11.1.241:40578</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Destination</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">158.115.141.254:7351</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Protocol</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">TCP</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Data Transferred</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">700 B</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #166534; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-check-circle"></i>
                                    Normal Traffic
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #047857; line-height: 1.6;">
                                    This flow shows normal traffic patterns. No immediate action required, but continue monitoring for changes.
                                </p>
                            </div>
                            
                            
                            <div style="background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #1e40af; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-tasks"></i>
                                    Next Actions
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #1e3a8a; line-height: 1.8;">
                                    
                                    <li><strong>Continue Monitoring:</strong> No immediate action needed</li>
                                    <li><strong>Baseline:</strong> Use this as reference for normal traffic patterns</li>
                                    
                                </ul>
                            </div>
                            
                            
                            <div style="background: #faf5ff; border: 1px solid #e9d5ff; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #7c3aed; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-filter"></i>
                                    Wireshark Filter
                                </h4>
                                <code style="display: block; padding: 10px 12px; background: #ffffff; border: 1px solid #ddd6fe; border-radius: 6px; font-size: 0.75rem; word-break: break-all; font-family: 'Courier New', monospace; color: #5b21b6;">ip.addr==10.11.1.241 && ip.addr==158.115.141.254</code>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #bbf7d0; border-radius: 8px; overflow: hidden; background: #f0fdf4;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-exchange-alt" style="color: #22c55e;"></i>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    10.11.1.241:51583
                                </span>
                                <span style="color: #9ca3af; font-weight: bold;"></span>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    10.199.2.100:53
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="background: #d1fae5; color: #047857; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                                    0.1%
                                </span>
                                <span style="background: #e0e7ff; color: #3730a3; padding: 4px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">
                                    TCP
                                </span>
                                <span style="color: #6b7280; font-size: 0.8125rem; font-weight: 500;">
                                    56 B
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                    <span style="font-weight: 600; color: #374151; font-size: 0.875rem;">Bandwidth Usage:</span>
                                    <div style="flex: 1; height: 12px; background: #e5e7eb; border-radius: 6px; overflow: hidden;">
                                        <div style="width: 0.1%; height: 100%; background: #22c55e; border-radius: 6px;"></div>
                                    </div>
                                    <span style="font-size: 0.875rem; color: #374151; font-weight: 600; min-width: 60px;">0.1%</span>
                                </div>
                            </div>
                            
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Source</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">10.11.1.241:51583</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Destination</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">10.199.2.100:53</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Protocol</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">TCP</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Data Transferred</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">56 B</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #166534; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-check-circle"></i>
                                    Normal Traffic
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #047857; line-height: 1.6;">
                                    This flow shows normal traffic patterns. No immediate action required, but continue monitoring for changes.
                                </p>
                            </div>
                            
                            
                            <div style="background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #1e40af; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-tasks"></i>
                                    Next Actions
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #1e3a8a; line-height: 1.8;">
                                    
                                    <li><strong>Continue Monitoring:</strong> No immediate action needed</li>
                                    <li><strong>Baseline:</strong> Use this as reference for normal traffic patterns</li>
                                    
                                </ul>
                            </div>
                            
                            
                            <div style="background: #faf5ff; border: 1px solid #e9d5ff; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #7c3aed; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-filter"></i>
                                    Wireshark Filter
                                </h4>
                                <code style="display: block; padding: 10px 12px; background: #ffffff; border: 1px solid #ddd6fe; border-radius: 6px; font-size: 0.75rem; word-break: break-all; font-family: 'Courier New', monospace; color: #5b21b6;">ip.addr==10.11.1.241 && ip.addr==10.199.2.100</code>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #bbf7d0; border-radius: 8px; overflow: hidden; background: #f0fdf4;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-exchange-alt" style="color: #22c55e;"></i>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    10.11.1.241:51583
                                </span>
                                <span style="color: #9ca3af; font-weight: bold;"></span>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    10.199.1.100:53
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="background: #d1fae5; color: #047857; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                                    0.1%
                                </span>
                                <span style="background: #e0e7ff; color: #3730a3; padding: 4px 10px; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">
                                    TCP
                                </span>
                                <span style="color: #6b7280; font-size: 0.8125rem; font-weight: 500;">
                                    56 B
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                    <span style="font-weight: 600; color: #374151; font-size: 0.875rem;">Bandwidth Usage:</span>
                                    <div style="flex: 1; height: 12px; background: #e5e7eb; border-radius: 6px; overflow: hidden;">
                                        <div style="width: 0.1%; height: 100%; background: #22c55e; border-radius: 6px;"></div>
                                    </div>
                                    <span style="font-size: 0.875rem; color: #374151; font-weight: 600; min-width: 60px;">0.1%</span>
                                </div>
                            </div>
                            
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Source</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">10.11.1.241:51583</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Destination</div>
                                    <code style="font-size: 0.875rem; color: #0f172a;">10.199.1.100:53</code>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Protocol</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">TCP</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Data Transferred</div>
                                    <span style="font-size: 0.875rem; color: #0f172a; font-weight: 600;">56 B</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #166534; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-check-circle"></i>
                                    Normal Traffic
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #047857; line-height: 1.6;">
                                    This flow shows normal traffic patterns. No immediate action required, but continue monitoring for changes.
                                </p>
                            </div>
                            
                            
                            <div style="background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #1e40af; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-tasks"></i>
                                    Next Actions
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #1e3a8a; line-height: 1.8;">
                                    
                                    <li><strong>Continue Monitoring:</strong> No immediate action needed</li>
                                    <li><strong>Baseline:</strong> Use this as reference for normal traffic patterns</li>
                                    
                                </ul>
                            </div>
                            
                            
                            <div style="background: #faf5ff; border: 1px solid #e9d5ff; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #7c3aed; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-filter"></i>
                                    Wireshark Filter
                                </h4>
                                <code style="display: block; padding: 10px 12px; background: #ffffff; border: 1px solid #ddd6fe; border-radius: 6px; font-size: 0.75rem; word-break: break-all; font-family: 'Courier New', monospace; color: #5b21b6;">ip.addr==10.11.1.241 && ip.addr==10.199.1.100</code>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    
                    
                </div>
                
                
                <div style="background: #f0fdf4; border-top: 1px solid #bbf7d0; padding: 20px 24px;">
                    <h4 style="margin: 0 0 12px 0; font-size: 0.9375rem; color: #166534; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-lightbulb"></i>
                        Traffic Management Tips
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                        <div style="background: #ffffff; border: 1px solid #bbf7d0; border-radius: 8px; padding: 14px;">
                            <div style="font-weight: 600; color: #166534; font-size: 0.875rem; margin-bottom: 8px;">
                                <i class="fas fa-tachometer-alt" style="color: #22c55e;"></i> QoS Prioritization
                            </div>
                            <p style="margin: 0; font-size: 0.8125rem; color: #047857;">Implement QoS policies to prioritize critical business traffic over bulk transfers.</p>
                        </div>
                        <div style="background: #ffffff; border: 1px solid #bbf7d0; border-radius: 8px; padding: 14px;">
                            <div style="font-weight: 600; color: #166534; font-size: 0.875rem; margin-bottom: 8px;">
                                <i class="fas fa-clock" style="color: #22c55e;"></i> Schedule Large Transfers
                            </div>
                            <p style="margin: 0; font-size: 0.8125rem; color: #047857;">Schedule backups and large file transfers during off-peak hours.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            
            
            <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; margin-bottom: 24px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                
                <div style="background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%); color: white; padding: 20px 24px;">
                    <h3 style="margin: 0 0 8px 0; font-size: 1.25rem; font-weight: 600; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-layer-group"></i>
                        Protocol Distribution Analysis
                        <span style="background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 0.875rem; font-weight: 500;">2 protocols</span>
                    </h3>
                    <p style="margin: 0; opacity: 0.9; font-size: 0.875rem;">Understand network protocol usage and identify anomalies</p>
                </div>
                
                
                <div style="background: #eef2ff; border-bottom: 1px solid #c7d2fe; padding: 20px 24px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px;">
                        <div style="background: #4f46e5; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div>
                            <h4 style="margin: 0 0 8px 0; color: #3730a3; font-size: 1rem;">Understanding Protocol Distribution</h4>
                            <p style="margin: 0 0 12px 0; color: #4338ca; font-size: 0.875rem; line-height: 1.6;">
                                Protocol distribution shows how network bandwidth is divided among different protocols. 
                                <strong>TCP</strong> typically dominates (web, email, apps), while <strong>UDP</strong> handles real-time traffic (VoIP, video). 
                                Unusual protocols may indicate <strong>security concerns</strong> or <strong>misconfigured applications</strong>.
                            </p>
                            <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap; font-size: 0.8125rem;">
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #22c55e; border-radius: 50%;"></span>
                                    <span style="color: #166534;">Expected protocols</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #f59e0b; border-radius: 50%;"></span>
                                    <span style="color: #92400e;">Monitor closely</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #ef4444; border-radius: 50%;"></span>
                                    <span style="color: #dc2626;">Investigate</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <div style="padding: 16px 24px;">
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #c7d2fe; border-radius: 8px; overflow: hidden; background: #f5f3ff;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-network-wired" style="color: #6366f1;"></i>
                                <span style="font-weight: 600; color: #1f2937; font-size: 1rem;">
                                    
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 120px; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden;">
                                    <div style="width: 13%; height: 100%; background: #6366f1; border-radius: 4px;"></div>
                                </div>
                                <span style="background: #e0e7ff; color: #3730a3; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; min-width: 60px; text-align: center;">
                                    12.6%
                                </span>
                                <span style="color: #6b7280; font-size: 0.8125rem; font-weight: 500; min-width: 80px; text-align: right;">
                                    11536
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Protocol Name</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 700;"></span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Total Data</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 600;">11536</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Share of Traffic</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 600;">12.6%</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #166534; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-info-circle"></i>
                                    About This Protocol
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #047857; line-height: 1.6;">
                                    This protocol is part of your network traffic mix. Review if this protocol is expected for your environment.
                                </p>
                            </div>
                            
                            
                            <div style="background: #fefce8; border: 1px solid #fef08a; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #854d0e; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-shield-alt"></i>
                                    Security Considerations
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #78350f; line-height: 1.8;">
                                    
                                    <li>Verify this protocol is expected in your environment</li>
                                    <li>Review firewall rules for this protocol</li>
                                    
                                </ul>
                            </div>
                            
                            
                            <div style="background: #faf5ff; border: 1px solid #e9d5ff; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #7c3aed; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-filter"></i>
                                    Wireshark Filter
                                </h4>
                                <code style="display: block; padding: 10px 12px; background: #ffffff; border: 1px solid #ddd6fe; border-radius: 6px; font-size: 0.75rem; word-break: break-all; font-family: 'Courier New', monospace; color: #5b21b6;">ip.proto</code>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #c7d2fe; border-radius: 8px; overflow: hidden; background: #f5f3ff;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-network-wired" style="color: #6366f1;"></i>
                                <span style="font-weight: 600; color: #1f2937; font-size: 1rem;">
                                    UDP
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 120px; height: 8px; background: #e5e7eb; border-radius: 4px; overflow: hidden;">
                                    <div style="width: 87%; height: 100%; background: #6366f1; border-radius: 4px;"></div>
                                </div>
                                <span style="background: #e0e7ff; color: #3730a3; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; min-width: 60px; text-align: center;">
                                    87.4%
                                </span>
                                <span style="color: #6b7280; font-size: 0.8125rem; font-weight: 500; min-width: 80px; text-align: right;">
                                    80356
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Protocol Name</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 700;">UDP</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Total Data</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 600;">80356</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Share of Traffic</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 600;">87.4%</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #166534; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-info-circle"></i>
                                    About This Protocol
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #047857; line-height: 1.6;">
                                    UDP (User Datagram Protocol) is used for real-time applications where speed is more important than reliability. Common uses include VoIP, video streaming, DNS queries, and online gaming.
                                    
                                </p>
                            </div>
                            
                            
                            <div style="background: #fefce8; border: 1px solid #fef08a; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #854d0e; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-shield-alt"></i>
                                    Security Considerations
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #78350f; line-height: 1.8;">
                                    
                                    <li>Watch for UDP floods which could indicate DDoS attacks</li>
                                    <li>Verify UDP traffic is from expected applications</li>
                                    
                                </ul>
                            </div>
                            
                            
                            <div style="background: #faf5ff; border: 1px solid #e9d5ff; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #7c3aed; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-filter"></i>
                                    Wireshark Filter
                                </h4>
                                <code style="display: block; padding: 10px 12px; background: #ffffff; border: 1px solid #ddd6fe; border-radius: 6px; font-size: 0.75rem; word-break: break-all; font-family: 'Courier New', monospace; color: #5b21b6;">udp</code>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    
                </div>
                
                
                <div style="background: #eef2ff; border-top: 1px solid #c7d2fe; padding: 20px 24px;">
                    <h4 style="margin: 0 0 12px 0; font-size: 0.9375rem; color: #3730a3; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-clipboard-check"></i>
                        Protocol Best Practices
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                        <div style="background: #ffffff; border: 1px solid #c7d2fe; border-radius: 8px; padding: 14px;">
                            <div style="font-weight: 600; color: #3730a3; font-size: 0.875rem; margin-bottom: 8px;">
                                <i class="fas fa-lock" style="color: #6366f1;"></i> Encrypt Traffic
                            </div>
                            <p style="margin: 0; font-size: 0.8125rem; color: #4338ca;">Ensure sensitive data uses encrypted protocols (HTTPS, TLS, SSH).</p>
                        </div>
                        <div style="background: #ffffff; border: 1px solid #c7d2fe; border-radius: 8px; padding: 14px;">
                            <div style="font-weight: 600; color: #3730a3; font-size: 0.875rem; margin-bottom: 8px;">
                                <i class="fas fa-ban" style="color: #6366f1;"></i> Block Unnecessary
                            </div>
                            <p style="margin: 0; font-size: 0.8125rem; color: #4338ca;">Disable protocols not required for business operations.</p>
                        </div>
                    </div>
                </div>
            </div>
            
        </section>
        
        
        <section id="protocols" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-layer-group" style="color: var(--color-primary);"></i>
                Protocol Analysis
            </h2>
            
            
            <div class="widget-grid mb-xl">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-globe"></i>
                            DNS Queries
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl);">2</div>
                        <p class="text-muted">Total DNS queries processed</p>
                    </div>
                </div>
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-bolt"></i>
                            HTTP/2 Flows
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl);">0</div>
                        <p class="text-muted">Modern HTTP/2 connections</p>
                    </div>
                </div>
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-rocket"></i>
                            QUIC Flows
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl);">0</div>
                        <p class="text-muted">QUIC protocol connections</p>
                    </div>
                </div>
            </div>
            
            
            
            <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; margin-bottom: 24px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                
                <div style="background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 20px 24px;">
                    <h3 style="margin: 0 0 8px 0; font-size: 1.25rem; font-weight: 600; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-globe"></i>
                        DNS Request/Response Analysis
                        <span style="background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 0.875rem; font-weight: 500;">2 queries</span>
                    </h3>
                    <p style="margin: 0; opacity: 0.9; font-size: 0.875rem;">Domain Name System queries and responses with timing analysis</p>
                </div>
                
                
                <div style="background: #ecfdf5; border-bottom: 1px solid #a7f3d0; padding: 20px 24px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px;">
                        <div style="background: #10b981; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div>
                            <h4 style="margin: 0 0 8px 0; color: #065f46; font-size: 1rem;">What is DNS?</h4>
                            <p style="margin: 0 0 12px 0; color: #047857; font-size: 0.875rem; line-height: 1.6;">
                                DNS (Domain Name System) translates human-readable domain names (like <code style="background: #d1fae5; padding: 2px 6px; border-radius: 4px;">google.com</code>) 
                                into IP addresses that computers use to communicate. Every website visit starts with a DNS query.
                            </p>
                            <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap; font-size: 0.8125rem; color: #064e3b;">
                                <span style="background: #dbeafe; color: #1e40af; padding: 2px 8px; border-radius: 4px;">Query</span>
                                <span></span>
                                <span style="background: #d1fae5; color: #047857; padding: 2px 8px; border-radius: 4px;">Response</span>
                                <span></span>
                                <span style="background: #f0fdf4; color: #166534; padding: 2px 8px; border-radius: 4px; border: 1px solid #86efac;">IP Address Resolved!</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <div style="background: #fafafa; border-bottom: 1px solid #e5e7eb; padding: 16px 24px;">
                    <div style="display: flex; flex-wrap: wrap; gap: 24px; align-items: center;">
                        <span style="font-weight: 600; color: #374151; font-size: 0.875rem;">Legend:</span>
                        
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 24px; background: #dbeafe; border: 3px solid #3b82f6; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-arrow-right" style="color: #3b82f6; font-size: 10px;"></i>
                            </div>
                            <span style="font-size: 0.8125rem; color: #1e40af; font-weight: 500;">Query</span>
                            <span style="font-size: 0.75rem; color: #64748b;">Client request</span>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 24px; background: #d1fae5; border: 3px solid #10b981; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-arrow-left" style="color: #10b981; font-size: 10px;"></i>
                            </div>
                            <span style="font-size: 0.8125rem; color: #047857; font-weight: 500;">Response</span>
                            <span style="font-size: 0.75rem; color: #64748b;">Server answer</span>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 24px; height: 24px; background: #fee2e2; border: 3px solid #ef4444; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-times" style="color: #ef4444; font-size: 10px;"></i>
                            </div>
                            <span style="font-size: 0.8125rem; color: #b91c1c; font-weight: 500;">Error/Timeout</span>
                            <span style="font-size: 0.75rem; color: #64748b;">No response</span>
                        </div>
                    </div>
                </div>
                
                
                <div style="padding: 16px 24px;">
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; border-color: #fca5a5;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; background: #fef2f2; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-globe" style="color: #ef4444;"></i>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    meraki.com
                                </span>
                                <span style="background: #dbeafe; color: #1e40af; padding: 2px 8px; border-radius: 4px; font-size: 0.6875rem; font-weight: 600;">A</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                
                                <span style="background: #fee2e2; color: #b91c1c; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; display: flex; align-items: center; gap: 4px;">
                                    <i class="fas fa-times-circle"></i> No Response
                                </span>
                                
                                
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="margin: 0 0 16px 0; font-size: 0.9375rem; color: #374151; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-stream" style="color: #10b981;"></i>
                                    DNS Resolution Timeline
                                </h4>
                                
                                <div style="display: flex; flex-direction: column; gap: 0;">
                                    
                                    <div style="display: flex; align-items: stretch; gap: 16px;">
                                        <div style="display: flex; flex-direction: column; align-items: center; width: 40px;">
                                            <div style="width: 40px; height: 40px; background: #dbeafe; border: 3px solid #3b82f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 1;">
                                                <i class="fas fa-arrow-right" style="color: #3b82f6;"></i>
                                            </div>
                                            <div style="width: 3px; flex: 1; background: linear-gradient(to bottom, #3b82f6, #ef4444); min-height: 20px;"></div>
                                        </div>
                                        <div style="flex: 1; background: #dbeafe; border-left: 4px solid #3b82f6; border-radius: 0 8px 8px 0; padding: 12px 16px; margin-bottom: 8px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                                <span style="font-weight: 700; color: #1e40af; font-size: 0.875rem;">DNS QUERY</span>
                                                <span style="font-size: 0.75rem; color: #3b82f6; background: white; padding: 2px 8px; border-radius: 4px;">Client  DNS Server</span>
                                            </div>
                                            <p style="margin: 0; color: #1e40af; font-size: 0.8125rem;">
                                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">10.11.1.241</code> queries for 
                                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">meraki.com</code> (Type: A)
                                            </p>
                                        </div>
                                    </div>
                                    
                                    
                                    
                                    <div style="display: flex; align-items: stretch; gap: 16px;">
                                        <div style="display: flex; flex-direction: column; align-items: center; width: 40px;">
                                            <div style="width: 40px; height: 40px; background: #fee2e2; border: 3px solid #ef4444; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 1;">
                                                <i class="fas fa-times" style="color: #ef4444;"></i>
                                            </div>
                                        </div>
                                        <div style="flex: 1; background: #fee2e2; border-left: 4px solid #ef4444; border-radius: 0 8px 8px 0; padding: 12px 16px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                                <span style="font-weight: 700; color: #b91c1c; font-size: 0.875rem;">NO RESPONSE</span>
                                                <span style="font-size: 0.75rem; color: #dc2626; background: white; padding: 2px 8px; border-radius: 4px;">Timeout</span>
                                            </div>
                                            <p style="margin: 0; color: #b91c1c; font-size: 0.8125rem;">DNS query did not receive a response from the server</p>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            
                            <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #475569; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-lightbulb" style="color: #eab308;"></i>
                                    What This Means
                                </h4>
                                <p style="margin: 0 0 8px 0; font-size: 0.8125rem; color: #64748b; line-height: 1.6;">
                                    <strong>Query Type:</strong> A - 
                                    Looking up the IPv4 address for this domain
                                </p>
                                
                                <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 6px; padding: 12px; margin-top: 8px;">
                                    <p style="margin: 0; font-size: 0.8125rem; color: #b91c1c; font-weight: 500;">
                                        <i class="fas fa-exclamation-triangle"></i> <strong>Resolution Failed:</strong> No response received from DNS server.
                                    </p>
                                    <p style="margin: 8px 0 0 0; font-size: 0.8125rem; color: #64748b;">
                                        Possible causes: DNS server unreachable, network issues, or the domain doesn't exist.
                                    </p>
                                </div>
                                
                                
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; border-color: #fca5a5;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; background: #fef2f2; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-globe" style="color: #ef4444;"></i>
                                <span style="font-family: 'Courier New', monospace; font-weight: 500; color: #1f2937;">
                                    meraki.com
                                </span>
                                <span style="background: #dbeafe; color: #1e40af; padding: 2px 8px; border-radius: 4px; font-size: 0.6875rem; font-weight: 600;">A</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                
                                <span style="background: #fee2e2; color: #b91c1c; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; display: flex; align-items: center; gap: 4px;">
                                    <i class="fas fa-times-circle"></i> No Response
                                </span>
                                
                                
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="margin-bottom: 20px;">
                                <h4 style="margin: 0 0 16px 0; font-size: 0.9375rem; color: #374151; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-stream" style="color: #10b981;"></i>
                                    DNS Resolution Timeline
                                </h4>
                                
                                <div style="display: flex; flex-direction: column; gap: 0;">
                                    
                                    <div style="display: flex; align-items: stretch; gap: 16px;">
                                        <div style="display: flex; flex-direction: column; align-items: center; width: 40px;">
                                            <div style="width: 40px; height: 40px; background: #dbeafe; border: 3px solid #3b82f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 1;">
                                                <i class="fas fa-arrow-right" style="color: #3b82f6;"></i>
                                            </div>
                                            <div style="width: 3px; flex: 1; background: linear-gradient(to bottom, #3b82f6, #ef4444); min-height: 20px;"></div>
                                        </div>
                                        <div style="flex: 1; background: #dbeafe; border-left: 4px solid #3b82f6; border-radius: 0 8px 8px 0; padding: 12px 16px; margin-bottom: 8px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                                <span style="font-weight: 700; color: #1e40af; font-size: 0.875rem;">DNS QUERY</span>
                                                <span style="font-size: 0.75rem; color: #3b82f6; background: white; padding: 2px 8px; border-radius: 4px;">Client  DNS Server</span>
                                            </div>
                                            <p style="margin: 0; color: #1e40af; font-size: 0.8125rem;">
                                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">10.11.1.241</code> queries for 
                                                <code style="background: white; padding: 2px 6px; border-radius: 4px;">meraki.com</code> (Type: A)
                                            </p>
                                        </div>
                                    </div>
                                    
                                    
                                    
                                    <div style="display: flex; align-items: stretch; gap: 16px;">
                                        <div style="display: flex; flex-direction: column; align-items: center; width: 40px;">
                                            <div style="width: 40px; height: 40px; background: #fee2e2; border: 3px solid #ef4444; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 1;">
                                                <i class="fas fa-times" style="color: #ef4444;"></i>
                                            </div>
                                        </div>
                                        <div style="flex: 1; background: #fee2e2; border-left: 4px solid #ef4444; border-radius: 0 8px 8px 0; padding: 12px 16px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                                <span style="font-weight: 700; color: #b91c1c; font-size: 0.875rem;">NO RESPONSE</span>
                                                <span style="font-size: 0.75rem; color: #dc2626; background: white; padding: 2px 8px; border-radius: 4px;">Timeout</span>
                                            </div>
                                            <p style="margin: 0; color: #b91c1c; font-size: 0.8125rem;">DNS query did not receive a response from the server</p>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            
                            <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #475569; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-lightbulb" style="color: #eab308;"></i>
                                    What This Means
                                </h4>
                                <p style="margin: 0 0 8px 0; font-size: 0.8125rem; color: #64748b; line-height: 1.6;">
                                    <strong>Query Type:</strong> A - 
                                    Looking up the IPv4 address for this domain
                                </p>
                                
                                <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 6px; padding: 12px; margin-top: 8px;">
                                    <p style="margin: 0; font-size: 0.8125rem; color: #b91c1c; font-weight: 500;">
                                        <i class="fas fa-exclamation-triangle"></i> <strong>Resolution Failed:</strong> No response received from DNS server.
                                    </p>
                                    <p style="margin: 8px 0 0 0; font-size: 0.8125rem; color: #64748b;">
                                        Possible causes: DNS server unreachable, network issues, or the domain doesn't exist.
                                    </p>
                                </div>
                                
                                
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    
                </div>
            </div>
            
            
            
            
            
            
            
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-book card-title-icon"></i>
                        Protocol Reference Guide
                    </h3>
                </div>
                <div class="card-body">
                    
		<div class="protocol-guide">
			<details class="guide-section">
				<summary><i class="fas fa-book-open"></i> Protocol Analysis Guide</summary>
				<div class="guide-content">
					<h4>Understanding Network Protocols</h4>
					
					<div class="protocol-explanation">
						<h5><i class="fas fa-exchange-alt"></i> TCP Handshakes</h5>
						<p><strong>Normal Behavior:</strong> TCP uses a three-way handshake to establish connections:</p>
						<ol>
							<li><strong>SYN:</strong> Client sends SYN packet to server</li>
							<li><strong>SYN-ACK:</strong> Server responds with SYN-ACK</li>
							<li><strong>ACK:</strong> Client sends final ACK to complete handshake</li>
						</ol>
						<p><strong>Abnormal Behavior:</strong> Failed handshakes occur when SYN packets receive no response (server down/firewalled) or receive RST (connection refused).</p>
						<p><strong>Wireshark Filters:</strong></p>
						<ul>
							<li><code>tcp.flags.syn == 1 and tcp.flags.ack == 0</code> - See SYN packets (connection attempts)</li>
							<li><code>tcp.flags.syn == 1 and tcp.flags.ack == 1</code> - See SYN-ACK packets (server responses)</li>
							<li><code>tcp.flags.reset == 1</code> - See RST packets (connection refused/aborted)</li>
							<li><code>tcp.analysis.flags</code> - See TCP analysis flags (retransmissions, out-of-order, etc.)</li>
						</ul>
					</div>
					
					<div class="protocol-explanation">
						<h5><i class="fas fa-globe"></i> HTTP/HTTPS</h5>
						<p><strong>Normal Behavior:</strong> HTTP requests receive 2xx (success) or 3xx (redirect) responses.</p>
						<p><strong>Abnormal Behavior:</strong> 4xx errors indicate client-side issues (404 Not Found, 403 Forbidden). 5xx errors indicate server-side failures (500 Internal Server Error, 503 Service Unavailable).</p>
						<p><strong>Wireshark Filters:</strong></p>
						<ul>
							<li><code>http.response.code >= 400</code> - See all HTTP errors</li>
							<li><code>http.response.code >= 500</code> - See server errors only</li>
							<li><code>http.request.method == "GET"</code> - See GET requests</li>
							<li><code>http.request.method == "POST"</code> - See POST requests</li>
							<li><code>ssl.handshake.type == 1</code> - See HTTPS ClientHello packets</li>
						</ul>
					</div>
					
					<div class="protocol-explanation">
						<h5><i class="fas fa-search"></i> DNS</h5>
						<p><strong>Normal Behavior:</strong> DNS queries receive responses with answer records. Response time is typically under 100ms.</p>
						<p><strong>Abnormal Behavior:</strong> NXDOMAIN (domain doesn't exist), timeouts (no response), excessive queries to random domains (DGA malware), or queries to suspicious domains.</p>
						<p><strong>Wireshark Filters:</strong></p>
						<ul>
							<li><code>dns.flags.response == 0</code> - See DNS queries</li>
							<li><code>dns.flags.response == 1</code> - See DNS responses</li>
							<li><code>dns.flags.rcode == 3</code> - See NXDOMAIN responses</li>
							<li><code>dns.time > 1</code> - See slow DNS responses (>1 second)</li>
							<li><code>dns.qry.name contains "suspicious"</code> - Search for specific domains</li>
						</ul>
					</div>
					
					<div class="protocol-explanation">
						<h5><i class="fas fa-network-wired"></i> ARP</h5>
						<p><strong>Normal Behavior:</strong> ARP requests receive a single response mapping an IP to a MAC address.</p>
						<p><strong>Abnormal Behavior:</strong> Multiple MAC addresses claiming the same IP (conflict), excessive ARP requests (scanning), or gratuitous ARP from unexpected sources (spoofing).</p>
						<p><strong>Wireshark Filters:</strong></p>
						<ul>
							<li><code>arp.opcode == 1</code> - See ARP requests (who-has)</li>
							<li><code>arp.opcode == 2</code> - See ARP replies (is-at)</li>
							<li><code>arp.duplicate-address-detected</code> - See ARP conflicts</li>
							<li><code>arp.src.proto_ipv4 == 192.168.1.1</code> - See ARP for specific IP</li>
						</ul>
					</div>
				</div>
			</details>
		</div>
	
                </div>
            </div>
            
        </section>
        
        
        <section id="tunnels" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-network-wired" style="color: var(--color-primary);"></i>
                Tunnels & SD-WAN Analysis
            </h2>
            
            
            <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; margin-bottom: 24px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                
                <div style="background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%); color: white; padding: 20px 24px;">
                    <h3 style="margin: 0 0 8px 0; font-size: 1.25rem; font-weight: 600; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-network-wired"></i>
                        Tunnel Analysis
                        <span style="background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 0.875rem; font-weight: 500;">0 detected</span>
                    </h3>
                    <p style="margin: 0; opacity: 0.9; font-size: 0.875rem;">Encapsulation protocols for secure and optimized traffic delivery</p>
                </div>
                
                
                <div style="background: #ecfeff; border-bottom: 1px solid #a5f3fc; padding: 20px 24px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px;">
                        <div style="background: #0891b2; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div>
                            <h4 style="margin: 0 0 8px 0; color: #0e7490; font-size: 1rem;">What are Network Tunnels?</h4>
                            <p style="margin: 0 0 12px 0; color: #0891b2; font-size: 0.875rem; line-height: 1.6;">
                                Tunnels encapsulate traffic inside other protocols for <strong>security</strong>, <strong>privacy</strong>, or <strong>network optimization</strong>. 
                                Common types include <strong>IPsec</strong> (VPN encryption), <strong>GRE</strong> (routing flexibility), <strong>VXLAN</strong> (data center overlay), 
                                and <strong>MPLS</strong> (carrier networks).
                            </p>
                            <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap; font-size: 0.8125rem;">
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #22c55e; border-radius: 50%;"></span>
                                    <span style="color: #166534;">Healthy tunnel</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #f59e0b; border-radius: 50%;"></span>
                                    <span style="color: #92400e;">Performance issue</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #ef4444; border-radius: 50%;"></span>
                                    <span style="color: #dc2626;">Tunnel failure</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <div style="padding: 16px 24px;">
                    
                    <div style="text-align: center; padding: 40px; color: #6b7280;">
                        <i class="fas fa-check-circle" style="font-size: 2rem; margin-bottom: 12px; color: #22c55e;"></i>
                        <p style="margin: 0 0 8px 0; font-size: 0.875rem; font-weight: 600;">No Tunnels Detected</p>
                        <p style="margin: 0; font-size: 0.8125rem; color: #9ca3af;">This capture contains no encapsulated tunnel traffic (IPsec, GRE, VXLAN, etc.)</p>
                    </div>
                    
                </div>
                
                
                <div style="background: #f0fdfa; border-top: 1px solid #99f6e4; padding: 20px 24px;">
                    <h4 style="margin: 0 0 12px 0; font-size: 0.9375rem; color: #0f766e; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-book"></i>
                        Common Tunnel Types Reference
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        <div style="background: #ffffff; border: 1px solid #99f6e4; border-radius: 8px; padding: 12px;">
                            <div style="font-weight: 600; color: #0f766e; font-size: 0.875rem;"><i class="fas fa-lock" style="color: #14b8a6;"></i> IPsec</div>
                            <p style="margin: 4px 0 0 0; font-size: 0.75rem; color: #0d9488;">Encrypted VPN tunnels</p>
                        </div>
                        <div style="background: #ffffff; border: 1px solid #99f6e4; border-radius: 8px; padding: 12px;">
                            <div style="font-weight: 600; color: #0f766e; font-size: 0.875rem;"><i class="fas fa-route" style="color: #14b8a6;"></i> GRE</div>
                            <p style="margin: 4px 0 0 0; font-size: 0.75rem; color: #0d9488;">Routing protocol tunnels</p>
                        </div>
                        <div style="background: #ffffff; border: 1px solid #99f6e4; border-radius: 8px; padding: 12px;">
                            <div style="font-weight: 600; color: #0f766e; font-size: 0.875rem;"><i class="fas fa-cloud" style="color: #14b8a6;"></i> VXLAN</div>
                            <p style="margin: 4px 0 0 0; font-size: 0.75rem; color: #0d9488;">Data center overlay</p>
                        </div>
                        <div style="background: #ffffff; border: 1px solid #99f6e4; border-radius: 8px; padding: 12px;">
                            <div style="font-weight: 600; color: #0f766e; font-size: 0.875rem;"><i class="fas fa-broadcast-tower" style="color: #14b8a6;"></i> MPLS</div>
                            <p style="margin: 4px 0 0 0; font-size: 0.75rem; color: #0d9488;">Carrier network labels</p>
                        </div>
                    </div>
                </div>
            </div>
            
            
            <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; margin-bottom: 24px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                
                <div style="background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%); color: white; padding: 20px 24px;">
                    <h3 style="margin: 0 0 8px 0; font-size: 1.25rem; font-weight: 600; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-sitemap"></i>
                        SD-WAN Vendor Detection
                        <span style="background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 0.875rem; font-weight: 500;">0 detected</span>
                    </h3>
                    <p style="margin: 0; opacity: 0.9; font-size: 0.875rem;">Identify SD-WAN solutions and vendor-specific traffic patterns</p>
                </div>
                
                
                <div style="background: #f5f3ff; border-bottom: 1px solid #ddd6fe; padding: 20px 24px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px;">
                        <div style="background: #7c3aed; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div>
                            <h4 style="margin: 0 0 8px 0; color: #5b21b6; font-size: 1rem;">Understanding SD-WAN Vendor Detection</h4>
                            <p style="margin: 0 0 12px 0; color: #7c3aed; font-size: 0.875rem; line-height: 1.6;">
                                SD-WAN vendors use unique signatures, ports, and protocols that can be detected in network traffic. 
                                Identifying vendors helps understand <strong>network architecture</strong>, <strong>troubleshoot vendor-specific issues</strong>, 
                                and ensure <strong>expected vendors are present</strong> in the environment.
                            </p>
                            <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap; font-size: 0.8125rem;">
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #22c55e; border-radius: 50%;"></span>
                                    <span style="color: #166534;">Expected vendor</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #f59e0b; border-radius: 50%;"></span>
                                    <span style="color: #92400e;">Unknown vendor</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #3b82f6; border-radius: 50%;"></span>
                                    <span style="color: #1d4ed8;">High confidence</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <div style="padding: 16px 24px;">
                    
                    <div style="text-align: center; padding: 40px; color: #6b7280;">
                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 12px; color: #9ca3af;"></i>
                        <p style="margin: 0 0 8px 0; font-size: 0.875rem; font-weight: 600;">No SD-WAN Vendors Detected</p>
                        <p style="margin: 0; font-size: 0.8125rem; color: #9ca3af;">No vendor-specific signatures found in this capture. This may indicate traditional WAN or unrecognized SD-WAN solution.</p>
                    </div>
                    
                </div>
                
                
                <div style="background: #faf5ff; border-top: 1px solid #e9d5ff; padding: 20px 24px;">
                    <h4 style="margin: 0 0 12px 0; font-size: 0.9375rem; color: #6b21a8; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-fingerprint"></i>
                        Detectable SD-WAN Vendors
                    </h4>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                        <span style="background: #ffffff; border: 1px solid #e9d5ff; border-radius: 20px; padding: 6px 14px; font-size: 0.8125rem; color: #7c3aed;">Cisco</span>
                        <span style="background: #ffffff; border: 1px solid #e9d5ff; border-radius: 20px; padding: 6px 14px; font-size: 0.8125rem; color: #7c3aed;">VMware</span>
                        <span style="background: #ffffff; border: 1px solid #e9d5ff; border-radius: 20px; padding: 6px 14px; font-size: 0.8125rem; color: #7c3aed;">Fortinet</span>
                        <span style="background: #ffffff; border: 1px solid #e9d5ff; border-radius: 20px; padding: 6px 14px; font-size: 0.8125rem; color: #7c3aed;">Palo Alto</span>
                        <span style="background: #ffffff; border: 1px solid #e9d5ff; border-radius: 20px; padding: 6px 14px; font-size: 0.8125rem; color: #7c3aed;">Silver Peak</span>
                        <span style="background: #ffffff; border: 1px solid #e9d5ff; border-radius: 20px; padding: 6px 14px; font-size: 0.8125rem; color: #7c3aed;">Versa</span>
                        <span style="background: #ffffff; border: 1px solid #e9d5ff; border-radius: 20px; padding: 6px 14px; font-size: 0.8125rem; color: #7c3aed;">Citrix</span>
                        <span style="background: #ffffff; border: 1px solid #e9d5ff; border-radius: 20px; padding: 6px 14px; font-size: 0.8125rem; color: #7c3aed;">Aryaka</span>
                    </div>
                </div>
            </div>
            
            
            
            
            
            <div style="background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; margin-bottom: 24px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                
                <div style="background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 20px 24px;">
                    <h3 style="margin: 0 0 8px 0; font-size: 1.25rem; font-weight: 600; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-globe-americas"></i>
                        Geographic Distribution
                        <span style="background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 0.875rem; font-weight: 500;">2 countries</span>
                    </h3>
                    <p style="margin: 0; opacity: 0.9; font-size: 0.875rem;">Analyze traffic origins and destinations by geographic location</p>
                </div>
                
                
                <div style="background: #ecfdf5; border-bottom: 1px solid #a7f3d0; padding: 20px 24px;">
                    <div style="display: flex; align-items: flex-start; gap: 16px;">
                        <div style="background: #059669; color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div>
                            <h4 style="margin: 0 0 8px 0; color: #047857; font-size: 1rem;">Understanding Geographic Distribution</h4>
                            <p style="margin: 0 0 12px 0; color: #059669; font-size: 0.875rem; line-height: 1.6;">
                                Geographic analysis reveals where network traffic originates and terminates. This helps identify 
                                <strong>expected business traffic</strong>, <strong>potential security threats</strong>, and 
                                <strong>compliance concerns</strong> related to data sovereignty.
                            </p>
                            <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap; font-size: 0.8125rem;">
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #22c55e; border-radius: 50%;"></span>
                                    <span style="color: #166534;">Expected region</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #f59e0b; border-radius: 50%;"></span>
                                    <span style="color: #92400e;">Review recommended</span>
                                </span>
                                <span style="display: flex; align-items: center; gap: 6px;">
                                    <span style="width: 12px; height: 12px; background: #ef4444; border-radius: 50%;"></span>
                                    <span style="color: #dc2626;">Security concern</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <div style="padding: 16px 24px;">
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #a7f3d0; border-radius: 8px; overflow: hidden; background: #f0fdf4;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-map-marker-alt" style="color: #059669;"></i>
                                <span style="font-weight: 700; color: #1f2937; font-size: 1rem;">
                                    Unknown (Class B)
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="background: #d1fae5; color: #047857; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                                    2 IPs
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Country/Region</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 700;">Unknown (Class B)</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Unique IP Addresses</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 600;">2</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #166534; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-info-circle"></i>
                                    What This Means
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #047857; line-height: 1.6;">
                                    Traffic detected from/to Unknown (Class B). Verify this aligns with your expected business operations and geographic footprint. 
                                    Consider data sovereignty requirements and compliance regulations that may apply to traffic crossing international boundaries.
                                </p>
                            </div>
                            
                            
                            <div style="background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #1e40af; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-tasks"></i>
                                    Next Actions
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #1e3a8a; line-height: 1.8;">
                                    <li><strong>Verify business need:</strong> Confirm traffic to/from Unknown (Class B) is expected</li>
                                    <li><strong>Check applications:</strong> Identify which applications communicate with this region</li>
                                    <li><strong>Review compliance:</strong> Ensure data handling meets regulatory requirements</li>
                                    <li><strong>Monitor volume:</strong> 2 unique IPs detected - verify this is normal</li>
                                </ul>
                            </div>
                            
                            
                            <div style="background: #fefce8; border: 1px solid #fef08a; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #854d0e; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-shield-alt"></i>
                                    Security Considerations
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #78350f; line-height: 1.8;">
                                    <li>Verify traffic is from legitimate business partners or services</li>
                                    <li>Check for unexpected data transfers to unfamiliar regions</li>
                                    <li>Review firewall logs for any blocked attempts from this region</li>
                                    <li>Consider geo-blocking if traffic is unauthorized</li>
                                </ul>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    <details style="margin-bottom: 12px; border: 1px solid #a7f3d0; border-radius: 8px; overflow: hidden; background: #f0fdf4;">
                        <summary style="display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; cursor: pointer; list-style: none; font-size: 0.875rem;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="fas fa-map-marker-alt" style="color: #059669;"></i>
                                <span style="font-weight: 700; color: #1f2937; font-size: 1rem;">
                                    Unknown (Class A)
                                </span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="background: #d1fae5; color: #047857; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                                    1 IPs
                                </span>
                            </div>
                        </summary>
                        
                        <div style="padding: 20px; background: #ffffff; border-top: 1px solid #e5e7eb;">
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Country/Region</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 700;">Unknown (Class A)</span>
                                </div>
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px;">
                                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">Unique IP Addresses</div>
                                    <span style="font-size: 1rem; color: #0f172a; font-weight: 600;">1</span>
                                </div>
                            </div>
                            
                            
                            <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #166534; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-info-circle"></i>
                                    What This Means
                                </h4>
                                <p style="margin: 0; font-size: 0.8125rem; color: #047857; line-height: 1.6;">
                                    Traffic detected from/to Unknown (Class A). Verify this aligns with your expected business operations and geographic footprint. 
                                    Consider data sovereignty requirements and compliance regulations that may apply to traffic crossing international boundaries.
                                </p>
                            </div>
                            
                            
                            <div style="background: #eff6ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #1e40af; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-tasks"></i>
                                    Next Actions
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #1e3a8a; line-height: 1.8;">
                                    <li><strong>Verify business need:</strong> Confirm traffic to/from Unknown (Class A) is expected</li>
                                    <li><strong>Check applications:</strong> Identify which applications communicate with this region</li>
                                    <li><strong>Review compliance:</strong> Ensure data handling meets regulatory requirements</li>
                                    <li><strong>Monitor volume:</strong> 1 unique IPs detected - verify this is normal</li>
                                </ul>
                            </div>
                            
                            
                            <div style="background: #fefce8; border: 1px solid #fef08a; border-radius: 8px; padding: 16px;">
                                <h4 style="margin: 0 0 12px 0; font-size: 0.875rem; color: #854d0e; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-shield-alt"></i>
                                    Security Considerations
                                </h4>
                                <ul style="margin: 0; padding-left: 20px; font-size: 0.8125rem; color: #78350f; line-height: 1.8;">
                                    <li>Verify traffic is from legitimate business partners or services</li>
                                    <li>Check for unexpected data transfers to unfamiliar regions</li>
                                    <li>Review firewall logs for any blocked attempts from this region</li>
                                    <li>Consider geo-blocking if traffic is unauthorized</li>
                                </ul>
                            </div>
                        </div>
                    </details>
                    
                    
                    
                    
                    
                </div>
                
                
                <div style="background: #ecfdf5; border-top: 1px solid #a7f3d0; padding: 20px 24px;">
                    <h4 style="margin: 0 0 12px 0; font-size: 0.9375rem; color: #047857; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-shield-alt"></i>
                        Geographic Security Best Practices
                    </h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                        <div style="background: #ffffff; border: 1px solid #a7f3d0; border-radius: 8px; padding: 14px;">
                            <div style="font-weight: 600; color: #047857; font-size: 0.875rem; margin-bottom: 8px;">
                                <i class="fas fa-ban" style="color: #10b981;"></i> Geo-Blocking
                            </div>
                            <p style="margin: 0; font-size: 0.8125rem; color: #059669;">Block traffic from regions with no business need to reduce attack surface.</p>
                        </div>
                        <div style="background: #ffffff; border: 1px solid #a7f3d0; border-radius: 8px; padding: 14px;">
                            <div style="font-weight: 600; color: #047857; font-size: 0.875rem; margin-bottom: 8px;">
                                <i class="fas fa-eye" style="color: #10b981;"></i> Monitor Anomalies
                            </div>
                            <p style="margin: 0; font-size: 0.8125rem; color: #059669;">Alert on traffic to new or unexpected geographic regions.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        
        <section id="visualizations" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-project-diagram" style="color: var(--color-primary);"></i>
                Network Visualizations
            </h2>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-network-wired card-title-icon"></i>
                        Network Topology
                    </h3>
                    <div class="card-actions">
                        <button class="card-action-button" onclick="resetTopology()">
                            <i class="fas fa-sync-alt"></i> Reset
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="network-diagram" class="chart-container" style="min-height: 600px; background: #ffffff; border: 1px solid var(--color-border); border-radius: var(--radius-md); position: relative;"></div>
                </div>
            </div>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-timeline card-title-icon"></i>
                        Event Timeline
                    </h3>
                </div>
                <div class="card-body">
                    <div id="timeline" class="chart-container"></div>
                </div>
            </div>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-stream card-title-icon"></i>
                        Traffic Flow Diagram
                    </h3>
                </div>
                <div class="card-body">
                    <div id="sankey-diagram" class="chart-container"></div>
                </div>
            </div>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-chart-bar card-title-icon"></i>
                        RTT Distribution
                    </h3>
                </div>
                <div class="card-body">
                    <div id="rtt-histogram" class="chart-container"></div>
                </div>
            </div>
        </section>
        
        
        <section id="devices" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-laptop" style="color: var(--color-primary);"></i>
                Device Fingerprinting
            </h2>
            
            
            <div class="card">
                <div class="card-body">
                    <p class="text-muted text-center">No devices fingerprinted.</p>
                </div>
            </div>
            
        </section>
        
    </main>
    
    
    <script>
        
        const networkData = {"links":[{"hasIssue":false,"packets":47,"protocol":"TCP","source":"10.11.1.241","target":"10.199.1.118","value":70735},{"hasIssue":false,"packets":5,"protocol":"TCP","source":"10.11.1.241","target":"158.115.136.228","value":8809},{"hasIssue":false,"packets":1,"protocol":"TCP","source":"10.11.1.241","target":"158.115.141.254","value":700},{"hasIssue":false,"packets":1,"protocol":"TCP","source":"10.11.1.241","target":"10.199.2.100","value":56},{"hasIssue":false,"packets":1,"protocol":"TCP","source":"10.11.1.241","target":"10.199.1.100","value":56}],"nodes":[{"bytes":80356,"connections":5,"group":"anomaly","hasIssue":true,"id":"10.11.1.241","label":"10.11.1.241"},{"bytes":70735,"connections":1,"group":"internal","id":"10.199.1.118","label":"10.199.1.118"},{"bytes":8809,"connections":1,"group":"external","id":"158.115.136.228","label":"158.115.136.228"},{"bytes":700,"connections":1,"group":"external","id":"158.115.141.254","label":"158.115.141.254"},{"bytes":56,"connections":1,"group":"internal","id":"10.199.2.100","label":"10.199.2.100"},{"bytes":56,"connections":1,"group":"internal","id":"10.199.1.100","label":"10.199.1.100"}]};
        const timelineData = [{"detail":"Query: meraki.com (A)","source":"10.11.1.241","target":"10.199.2.100","timestamp":1768400848.9599009,"type":"DNS Query"},{"detail":"Query: meraki.com (A)","source":"10.11.1.241","target":"10.199.1.100","timestamp":1768400848.960046,"type":"DNS Query"}];
        const sankeyData = {"links":[{"source":0,"target":1,"value":80356},{"source":1,"target":2,"value":80356}],"nodes":[{"name":"Internal Network"},{"name":"Gateway"},{"name":"Internet"}]};
        const rttHistogramData = [{"bucket":"0-10ms","count":0},{"bucket":"10-50ms","count":0},{"bucket":"50-100ms","count":0},{"bucket":"100-200ms","count":0},{"bucket":"200-500ms","count":0},{"bucket":"500-1000ms","count":0},{"bucket":"1000ms+","count":0}];
        
        
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                
                const section = this.dataset.section;
                document.querySelectorAll('.dashboard-section').forEach(s => s.style.display = 'none');
                document.getElementById(section).style.display = 'block';
                
                
                document.getElementById('currentSection').textContent = this.textContent.trim();
                
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        
        
        document.getElementById('globalSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            
            
            document.querySelectorAll('.data-table tbody tr').forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });
        
        
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            const button = event.target.closest('button');
            const icon = button.querySelector('i');
            
            if (section.style.display === 'none') {
                section.style.display = 'block';
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            } else {
                section.style.display = 'none';
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            }
        }
        
        
        function exportTableToCSV(tableId, filename) {
            const table = document.getElementById(tableId);
            let csv = [];
            
            
            const headers = Array.from(table.querySelectorAll('thead th')).map(th => th.textContent);
            csv.push(headers.join(','));
            
            
            table.querySelectorAll('tbody tr').forEach(row => {
                const cells = Array.from(row.querySelectorAll('td')).map(td => {
                    let text = td.textContent.trim();
                    
                    if (text.includes(',') || text.includes('"')) {
                        text = '"' + text.replace(/"/g, '""') + '"';
                    }
                    return text;
                });
                csv.push(cells.join(','));
            });
            
            
            const blob = new Blob([csv.join('\n')], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        }
        
        
        function resetTopology() {
            
            if (typeof createNetworkDiagram === 'function') {
                const container = document.getElementById('network-diagram');
                container.innerHTML = '';
                createNetworkDiagram(container, networkData);
            }
        }
        
        
        function filterTCPFlows(searchText) {
            const table = document.getElementById('tcp-flow-table');
            if (!table) return;
            
            const rows = table.querySelectorAll('tbody tr.tcp-flow-row');
            const search = searchText.toLowerCase().trim();
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }
        
        
        let tcpSortDirection = {};
        function sortTCPTable(columnIndex) {
            const table = document.getElementById('tcp-flow-table');
            if (!table) return;
            
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr.tcp-flow-row'));
            
            
            tcpSortDirection[columnIndex] = !tcpSortDirection[columnIndex];
            const ascending = tcpSortDirection[columnIndex];
            
            rows.sort((a, b) => {
                let aVal = a.cells[columnIndex].textContent.trim();
                let bVal = b.cells[columnIndex].textContent.trim();
                
                
                if (columnIndex === 3 || columnIndex === 4) {
                    aVal = parseInt(aVal) || 0;
                    bVal = parseInt(bVal) || 0;
                    return ascending ? aVal - bVal : bVal - aVal;
                }
                
                
                return ascending ? aVal.localeCompare(bVal) : bVal.localeCompare(aVal);
            });
            
            
            rows.forEach(row => tbody.appendChild(row));
            
            
            const headers = table.querySelectorAll('thead th');
            headers.forEach((th, i) => {
                const icon = th.querySelector('i.fa-sort, i.fa-sort-up, i.fa-sort-down');
                if (icon) {
                    if (i === columnIndex) {
                        icon.className = ascending ? 'fas fa-sort-up' : 'fas fa-sort-down';
                    } else {
                        icon.className = 'fas fa-sort';
                    }
                }
            });
        }
        
        
        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(() => {
                const icon = button.querySelector('i');
                const originalClass = icon.className;
                icon.className = 'fas fa-check';
                button.style.background = '#00B894';
                button.style.color = 'white';
                button.style.borderColor = '#00B894';
                
                setTimeout(() => {
                    icon.className = originalClass;
                    button.style.background = '';
                    button.style.color = '';
                    button.style.borderColor = '';
                }, 1500);
            }).catch(err => {
                console.error('Failed to copy:', err);
                
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            });
        }
        
        
        function initializeVisualizations() {
            try {
                if (networkData && networkData.nodes && networkData.nodes.length > 0) {
                    createNetworkDiagram(document.getElementById('network-diagram'), networkData);
                }
                
                if (timelineData && timelineData.length > 0) {
                    createTimeline(document.getElementById('timeline'), timelineData);
                }
                
                if (sankeyData && sankeyData.nodes && sankeyData.nodes.length > 0) {
                    createSankeyDiagram(document.getElementById('sankey-diagram'), sankeyData);
                }
                
                if (rttHistogramData && rttHistogramData.length > 0) {
                    createRTTHistogram(document.getElementById('rtt-histogram'), rttHistogramData);
                }
            } catch (error) {
                console.error('Error initializing visualizations:', error);
            }
        }
        
        
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(initializeVisualizations, 100);
        });
    </script>
    
    
    <script>// SD-WAN Triage Report Visualizations - Simplified Implementation
// Clean, minimal D3.js force-directed graph

// Theme-aware color utilities
function getThemeColors() {
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
    return {
        primary: '#3b82f6',
        success: '#10b981',
        warning: '#f59e0b',
        danger: '#ef4444',
        text: isDark ? '#f1f5f9' : '#1e293b',
        background: isDark ? '#1e293b' : '#ffffff',
        border: isDark ? '#334155' : '#e2e8f0'
    };
}

// Network Diagram - Simple, Clean Force-Directed Graph
function createNetworkDiagram(container, data) {
    // Clear existing content
    d3.select(container).selectAll("*").remove();
    
    // Validate data
    if (!data || !data.nodes || !data.links || data.nodes.length === 0) {
        container.innerHTML = '<div style="padding: 40px; text-align: center; color: #64748b;">No network data available</div>';
        return;
    }
    
    // Dimensions
    const width = container.clientWidth || 800;
    const height = 500;
    
    // Create SVG with white background
    const svg = d3.select(container)
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "#ffffff")
        .style("border", "1px solid #e0e0e0")
        .style("border-radius", "8px");
    
    // Create main group for zoom/pan
    const g = svg.append("g");
    
    // Add zoom behavior
    svg.call(d3.zoom()
        .scaleExtent([0.5, 3])
        .on("zoom", (event) => g.attr("transform", event.transform)));
    
    // Define arrowhead marker - CRITICAL: markerUnits prevents scaling issues
    svg.append("defs")
        .append("marker")
        .attr("id", "arrow")
        .attr("viewBox", "0 -5 10 10")
        .attr("refX", 12)
        .attr("refY", 0)
        .attr("markerWidth", 3)
        .attr("markerHeight", 3)
        .attr("markerUnits", "strokeWidth")
        .attr("orient", "auto")
        .append("path")
        .attr("d", "M0,-5L10,0L0,5")
        .attr("fill", "#94a3b8");
    
    // Simple color mapping
    const nodeColors = {
        "internal": "#10b981",
        "router": "#3b82f6",
        "external": "#f59e0b",
        "anomaly": "#ef4444"
    };
    
    // Create tooltip
    const tooltip = d3.select("body")
        .append("div")
        .attr("class", "d3-tooltip")
        .style("position", "absolute")
        .style("opacity", 0)
        .style("background", "rgba(0,0,0,0.8)")
        .style("color", "white")
        .style("padding", "8px 12px")
        .style("border-radius", "4px")
        .style("font-size", "12px")
        .style("pointer-events", "none")
        .style("z-index", "10000");
    
    // Simple force simulation
    const simulation = d3.forceSimulation(data.nodes)
        .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
        .force("charge", d3.forceManyBody().strength(-300))
        .force("center", d3.forceCenter(width / 2, height / 2))
        .force("collision", d3.forceCollide().radius(30));
    
    // Draw links
    const link = g.append("g")
        .selectAll("line")
        .data(data.links)
        .join("line")
        .attr("stroke", d => d.hasIssue ? "#ef4444" : "#cbd5e1")
        .attr("stroke-width", d => {
            const bytes = d.value || 0;
            if (bytes > 10000000) return 3;
            if (bytes > 1000000) return 2;
            return 1;
        })
        .attr("stroke-dasharray", d => d.hasIssue ? "4,4" : "0")
        .attr("marker-end", "url(#arrow)");
    
    // Draw nodes
    const node = g.append("g")
        .selectAll("circle")
        .data(data.nodes)
        .join("circle")
        .attr("r", d => d.group === "router" ? 10 : 8)
        .attr("fill", d => nodeColors[d.group] || "#94a3b8")
        .attr("stroke", "#fff")
        .attr("stroke-width", 2)
        .style("cursor", "pointer")
        .call(d3.drag()
            .on("start", dragStarted)
            .on("drag", dragged)
            .on("end", dragEnded))
        .on("mouseover", function(event, d) {
            d3.select(this)
                .attr("stroke-width", 3)
                .attr("r", d.group === "router" ? 12 : 10);
            
            tooltip.transition().duration(200).style("opacity", 1);
            tooltip.html(`
                <strong>${d.id}</strong><br/>
                Type: ${d.group}<br/>
                ${d.bytes ? `Traffic: ${formatBytes(d.bytes)}` : ''}
            `)
                .style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY - 10) + "px");
        })
        .on("mouseout", function(event, d) {
            d3.select(this)
                .attr("stroke-width", 2)
                .attr("r", d.group === "router" ? 10 : 8);
            
            tooltip.transition().duration(500).style("opacity", 0);
        });
    
    // Add labels
    const label = g.append("g")
        .selectAll("text")
        .data(data.nodes)
        .join("text")
        .text(d => d.id)
        .attr("font-size", "11px")
        .attr("dx", 12)
        .attr("dy", 4)
        .attr("fill", "#1e293b")
        .attr("stroke", "#fff")
        .attr("stroke-width", 3)
        .attr("paint-order", "stroke")
        .style("pointer-events", "none");
    
    // Update positions on simulation tick
    simulation.on("tick", () => {
        link
            .attr("x1", d => d.source.x)
            .attr("y1", d => d.source.y)
            .attr("x2", d => d.target.x)
            .attr("y2", d => d.target.y);
        
        node
            .attr("cx", d => d.x)
            .attr("cy", d => d.y);
        
        label
            .attr("x", d => d.x)
            .attr("y", d => d.y);
    });
    
    // Drag functions
    function dragStarted(event, d) {
        if (!event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
    }
    
    function dragged(event, d) {
        d.fx = event.x;
        d.fy = event.y;
    }
    
    function dragEnded(event, d) {
        if (!event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }
    
    // Helper function
    function formatBytes(bytes) {
        if (bytes < 1024) return bytes + ' B';
        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
        if (bytes < 1024 * 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        return (bytes / (1024 * 1024 * 1024)).toFixed(2) + ' GB';
    }
    
    // Add simple legend
    const legend = svg.append("g")
        .attr("transform", `translate(20, ${height - 120})`);
    
    legend.append("rect")
        .attr("width", 160)
        .attr("height", 110)
        .attr("fill", "rgba(255,255,255,0.95)")
        .attr("stroke", "#e0e0e0")
        .attr("rx", 4);
    
    const legendItems = [
        { label: "Internal", color: "#10b981" },
        { label: "Router", color: "#3b82f6" },
        { label: "External", color: "#f59e0b" },
        { label: "Anomaly", color: "#ef4444" }
    ];
    
    legendItems.forEach((item, i) => {
        const lg = legend.append("g")
            .attr("transform", `translate(10, ${i * 25 + 15})`);
        
        lg.append("circle")
            .attr("r", 6)
            .attr("fill", item.color)
            .attr("stroke", "#fff")
            .attr("stroke-width", 1);
        
        lg.append("text")
            .attr("x", 15)
            .attr("y", 4)
            .attr("font-size", "12px")
            .attr("fill", "#1e293b")
            .text(item.label);
    });
}

// Timeline Visualization
function createTimeline(container, data) {
    d3.select(container).selectAll("*").remove();
    
    // Data is an array directly, not data.events
    if (!data || !Array.isArray(data) || data.length === 0) {
        container.innerHTML = '<div style="padding: 40px; text-align: center; color: #64748b;"><i class="fas fa-clock" style="font-size: 2rem; margin-bottom: 12px; display: block;"></i>No timeline events available<br/><small style="color: #9ca3af;">Timeline events are generated from network activity patterns</small></div>';
        return;
    }
    
    const width = container.clientWidth || 800;
    const height = 400;
    const margin = {top: 40, right: 40, bottom: 60, left: 120};
    const chartWidth = width - margin.left - margin.right;
    const chartHeight = height - margin.top - margin.bottom;
    
    const svg = d3.select(container)
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "#ffffff")
        .style("border", "1px solid #e0e0e0")
        .style("border-radius", "8px");
    
    const g = svg.append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);
    
    // Parse timestamps - data comes as array with timestamp, type, source, target, detail
    const events = data.map(e => ({
        time: new Date(e.timestamp * 1000),
        type: e.type || 'unknown',
        source: e.source || '',
        target: e.target || '',
        detail: e.detail || ''
    }));
    
    const xScale = d3.scaleTime()
        .domain(d3.extent(events, d => d.time))
        .range([0, chartWidth]);
    
    const eventTypes = [...new Set(events.map(e => e.type))];
    const yScale = d3.scaleBand()
        .domain(eventTypes)
        .range([0, chartHeight])
        .padding(0.3);
    
    const colorScale = d3.scaleOrdinal()
        .domain(eventTypes)
        .range(['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899']);
    
    // Add axes
    g.append("g")
        .attr("transform", `translate(0,${chartHeight})`)
        .call(d3.axisBottom(xScale).ticks(6))
        .selectAll("text")
        .style("font-size", "11px");
    
    g.append("g")
        .call(d3.axisLeft(yScale))
        .selectAll("text")
        .style("font-size", "11px");
    
    // Add events
    g.selectAll(".event")
        .data(events)
        .join("circle")
        .attr("class", "event")
        .attr("cx", d => xScale(d.time))
        .attr("cy", d => yScale(d.type) + yScale.bandwidth() / 2)
        .attr("r", 5)
        .attr("fill", d => colorScale(d.type))
        .attr("stroke", "#fff")
        .attr("stroke-width", 2)
        .style("cursor", "pointer")
        .on("mouseover", function(event, d) {
            d3.select(this).attr("r", 7);
            let tooltipHtml = '<strong>' + d.type + '</strong><br/>';
            if (d.source && d.target) tooltipHtml += d.source + ' -> ' + d.target + '<br/>';
            if (d.detail) tooltipHtml += d.detail + '<br/>';
            tooltipHtml += d.time.toLocaleString();
            showTooltip(event, tooltipHtml);
        })
        .on("mouseout", function() {
            d3.select(this).attr("r", 5);
            hideTooltip();
        });
    
    // Add title
    svg.append("text")
        .attr("x", width / 2)
        .attr("y", 20)
        .attr("text-anchor", "middle")
        .style("font-size", "14px")
        .style("font-weight", "600")
        .text("Event Timeline");
}

// Sankey Diagram for Traffic Flows
function createSankeyDiagram(container, data) {
    d3.select(container).selectAll("*").remove();
    
    // Data comes with nodes having 'name' property and links with source/target as indices
    if (!data || !data.nodes || !data.links || data.nodes.length === 0 || data.links.length === 0) {
        container.innerHTML = '<div style="padding: 40px; text-align: center; color: #64748b;"><i class="fas fa-stream" style="font-size: 2rem; margin-bottom: 12px; display: block;"></i>No traffic flow data available<br/><small style="color: #9ca3af;">Traffic flow diagram requires captured network flows</small></div>';
        return;
    }
    
    const width = container.clientWidth || 800;
    const height = 400;
    const margin = {top: 40, right: 40, bottom: 40, left: 40};
    
    const svg = d3.select(container)
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "#ffffff")
        .style("border", "1px solid #e0e0e0")
        .style("border-radius", "8px");
    
    const g = svg.append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);
    
    const chartWidth = width - margin.left - margin.right;
    const chartHeight = height - margin.top - margin.bottom;
    
    // Nodes have 'name' property from Go code
    const nodes = data.nodes;
    const links = data.links;
    
    // Position nodes evenly across the width
    const nodeWidth = 140;
    const nodeHeight = 50;
    const nodeSpacing = chartWidth / (nodes.length + 1);
    
    // Calculate node positions
    nodes.forEach((node, i) => {
        node.x = nodeSpacing * (i + 1) - nodeWidth / 2;
        node.y = chartHeight / 2 - nodeHeight / 2;
    });
    
    // Color scale for nodes
    const colors = ['#3b82f6', '#8b5cf6', '#10b981'];
    
    // Draw links first (behind nodes)
    links.forEach(link => {
        const sourceNode = nodes[link.source];
        const targetNode = nodes[link.target];
        
        if (sourceNode && targetNode) {
            const x1 = sourceNode.x + nodeWidth;
            const y1 = sourceNode.y + nodeHeight / 2;
            const x2 = targetNode.x;
            const y2 = targetNode.y + nodeHeight / 2;
            const midX = (x1 + x2) / 2;
            
            const path = d3.path();
            path.moveTo(x1, y1);
            path.bezierCurveTo(midX, y1, midX, y2, x2, y2);
            
            // Scale link width based on value
            const maxValue = d3.max(links, l => l.value) || 1;
            const linkWidth = Math.max(4, (link.value / maxValue) * 40);
            
            g.append("path")
                .attr("d", path.toString())
                .attr("fill", "none")
                .attr("stroke", "#94a3b8")
                .attr("stroke-width", linkWidth)
                .attr("opacity", 0.5)
                .style("cursor", "pointer")
                .on("mouseover", function(event) {
                    d3.select(this).attr("opacity", 0.8).attr("stroke", "#3b82f6");
                    showTooltip(event, '<strong>' + sourceNode.name + ' -> ' + targetNode.name + '</strong><br/>Traffic: ' + formatBytesSankey(link.value));
                })
                .on("mouseout", function() {
                    d3.select(this).attr("opacity", 0.5).attr("stroke", "#94a3b8");
                    hideTooltip();
                });
        }
    });
    
    // Draw nodes
    nodes.forEach((node, i) => {
        const nodeG = g.append("g")
            .attr("transform", 'translate(' + node.x + ', ' + node.y + ')');
        
        nodeG.append("rect")
            .attr("width", nodeWidth)
            .attr("height", nodeHeight)
            .attr("fill", colors[i % colors.length])
            .attr("rx", 6)
            .style("cursor", "pointer");
        
        nodeG.append("text")
            .attr("x", nodeWidth / 2)
            .attr("y", nodeHeight / 2 + 5)
            .attr("text-anchor", "middle")
            .attr("fill", "#fff")
            .style("font-size", "12px")
            .style("font-weight", "600")
            .text(node.name);
    });
    
    // Add title
    svg.append("text")
        .attr("x", width / 2)
        .attr("y", 20)
        .attr("text-anchor", "middle")
        .style("font-size", "14px")
        .style("font-weight", "600")
        .text("Traffic Flow Diagram");
    
    function formatBytesSankey(bytes) {
        if (bytes < 1024) return bytes + ' B';
        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
        if (bytes < 1024 * 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        return (bytes / (1024 * 1024 * 1024)).toFixed(2) + ' GB';
    }
}

// RTT Histogram
function createRTTHistogram(container, data) {
    d3.select(container).selectAll("*").remove();
    
    // Data comes as array of {bucket: "0-10ms", count: N} objects from Go
    if (!data || !Array.isArray(data) || data.length === 0) {
        container.innerHTML = '<div style="padding: 40px; text-align: center; color: #64748b;"><i class="fas fa-chart-bar" style="font-size: 2rem; margin-bottom: 12px; display: block;"></i>No RTT data available<br/><small style="color: #9ca3af;">RTT distribution requires TCP flow analysis data</small></div>';
        return;
    }
    
    const width = container.clientWidth || 800;
    const height = 400;
    const margin = {top: 40, right: 40, bottom: 80, left: 60};
    const chartWidth = width - margin.left - margin.right;
    const chartHeight = height - margin.top - margin.bottom;
    
    const svg = d3.select(container)
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "#ffffff")
        .style("border", "1px solid #e0e0e0")
        .style("border-radius", "8px");
    
    const g = svg.append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);
    
    // Use bucket labels for x-axis (categorical)
    const buckets = data.map(d => d.bucket);
    const counts = data.map(d => d.count);
    
    const xScale = d3.scaleBand()
        .domain(buckets)
        .range([0, chartWidth])
        .padding(0.2);
    
    const yScale = d3.scaleLinear()
        .domain([0, d3.max(counts) || 1])
        .range([chartHeight, 0]);
    
    // Color scale based on RTT severity
    const colorScale = function(bucket) {
        if (bucket.includes('0-10') || bucket.includes('10-50')) return '#22c55e';
        if (bucket.includes('50-100') || bucket.includes('100-200')) return '#f59e0b';
        return '#ef4444';
    };
    
    // Add x-axis
    g.append("g")
        .attr("transform", `translate(0,${chartHeight})`)
        .call(d3.axisBottom(xScale))
        .selectAll("text")
        .style("font-size", "11px")
        .attr("transform", "rotate(-30)")
        .attr("text-anchor", "end");
    
    // Add y-axis
    g.append("g")
        .call(d3.axisLeft(yScale).ticks(5))
        .selectAll("text")
        .style("font-size", "11px");
    
    // Add bars
    g.selectAll(".bar")
        .data(data)
        .join("rect")
        .attr("class", "bar")
        .attr("x", d => xScale(d.bucket))
        .attr("y", d => yScale(d.count))
        .attr("width", xScale.bandwidth())
        .attr("height", d => chartHeight - yScale(d.count))
        .attr("fill", d => colorScale(d.bucket))
        .attr("opacity", 0.85)
        .attr("rx", 4)
        .style("cursor", "pointer")
        .on("mouseover", function(event, d) {
            d3.select(this).attr("opacity", 1);
            showTooltip(event, '<strong>RTT: ' + d.bucket + '</strong><br/>Count: ' + d.count + ' flows');
        })
        .on("mouseout", function() {
            d3.select(this).attr("opacity", 0.85);
            hideTooltip();
        });
    
    // Add value labels on bars
    g.selectAll(".label")
        .data(data)
        .join("text")
        .attr("class", "label")
        .attr("x", d => xScale(d.bucket) + xScale.bandwidth() / 2)
        .attr("y", d => yScale(d.count) - 5)
        .attr("text-anchor", "middle")
        .style("font-size", "11px")
        .style("font-weight", "600")
        .style("fill", "#374151")
        .text(d => d.count > 0 ? d.count : '');
    
    // Add title
    svg.append("text")
        .attr("x", width / 2)
        .attr("y", 20)
        .attr("text-anchor", "middle")
        .style("font-size", "14px")
        .style("font-weight", "600")
        .text("RTT Distribution");
    
    // Add y-axis label
    svg.append("text")
        .attr("transform", "rotate(-90)")
        .attr("x", -height / 2)
        .attr("y", 15)
        .attr("text-anchor", "middle")
        .style("font-size", "12px")
        .style("fill", "#64748b")
        .text("Number of Flows");
    
    // Add legend
    const legend = svg.append("g")
        .attr("transform", `translate(${width - 150}, 40)`);
    
    const legendItems = [
        { label: "Good (<50ms)", color: "#22c55e" },
        { label: "Moderate", color: "#f59e0b" },
        { label: "High (>200ms)", color: "#ef4444" }
    ];
    
    legendItems.forEach((item, i) => {
        const lg = legend.append("g")
            .attr("transform", `translate(0, ${i * 20})`);
        
        lg.append("rect")
            .attr("width", 14)
            .attr("height", 14)
            .attr("fill", item.color)
            .attr("rx", 2);
        
        lg.append("text")
            .attr("x", 20)
            .attr("y", 11)
            .style("font-size", "11px")
            .style("fill", "#374151")
            .text(item.label);
    });
}

// Tooltip helper functions
function showTooltip(event, html) {
    let tooltip = d3.select(".d3-tooltip");
    if (tooltip.empty()) {
        tooltip = d3.select("body")
            .append("div")
            .attr("class", "d3-tooltip")
            .style("position", "absolute")
            .style("background", "rgba(0,0,0,0.8)")
            .style("color", "white")
            .style("padding", "8px 12px")
            .style("border-radius", "4px")
            .style("font-size", "12px")
            .style("pointer-events", "none")
            .style("z-index", "10000");
    }
    tooltip.html(html)
        .style("left", (event.pageX + 10) + "px")
        .style("top", (event.pageY - 10) + "px")
        .style("opacity", 1);
}

function hideTooltip() {
    d3.select(".d3-tooltip")
        .style("opacity", 0);
}
</script>
</body>
</html>
