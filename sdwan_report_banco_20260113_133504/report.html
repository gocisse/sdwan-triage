<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SD-WAN Network Triage - banco.pcap</title>
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    
    <style>/* ============================================================================
   SD-WAN Triage - Enterprise Dashboard CSS
   Inspired by Motadata and ManageEngine OpManager
   Modern, Clean, Professional Network Management UI
   ============================================================================ */

/* ============================================================================
   1. CSS VARIABLES - DESIGN SYSTEM
   ============================================================================ */
:root {
    /* Primary Color Palette */
    --color-primary: #0055A4;
    --color-primary-dark: #003366;
    --color-primary-light: #0066CC;
    
    /* Secondary & Background Colors */
    --color-secondary: #F5F7FA;
    --color-background: #FFFFFF;
    --color-surface: #FAFBFC;
    --color-border: #E1E8ED;
    --color-border-light: #F0F3F7;
    
    /* Accent Colors */
    --color-success: #00B894;
    --color-success-light: #E8F8F5;
    --color-warning: #FDCB6E;
    --color-warning-light: #FFF9E6;
    --color-critical: #E17055;
    --color-critical-light: #FFE8E3;
    --color-info: #74B9FF;
    --color-info-light: #E3F2FD;
    
    /* Text Colors */
    --color-text-primary: #2D3436;
    --color-text-secondary: #636E72;
    --color-text-muted: #95A5A6;
    --color-text-inverse: #FFFFFF;
    
    /* Status Colors */
    --color-healthy: #00B894;
    --color-warning-status: #FDCB6E;
    --color-critical-status: #E17055;
    --color-unknown: #95A5A6;
    
    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    
    /* Border Radius */
    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;
    --radius-full: 9999px;
    
    /* Spacing Scale */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 2rem;
    --space-2xl: 3rem;
    --space-3xl: 4rem;
    
    /* Typography */
    --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    --font-family-mono: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
    
    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-base: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.25rem;
    --font-size-2xl: 1.5rem;
    --font-size-3xl: 1.875rem;
    --font-size-4xl: 2.25rem;
    
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    
    /* Transitions */
    --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Z-Index Scale */
    --z-dropdown: 1000;
    --z-sticky: 1020;
    --z-fixed: 1030;
    --z-modal-backdrop: 1040;
    --z-modal: 1050;
    --z-popover: 1060;
    --z-tooltip: 1070;
}

/* ============================================================================
   2. RESET & BASE STYLES
   ============================================================================ */
*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font-family: var(--font-family);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-normal);
    line-height: 1.6;
    color: var(--color-text-primary);
    background-color: var(--color-secondary);
    overflow-x: hidden;
}

/* ============================================================================
   3. TYPOGRAPHY
   ============================================================================ */
h1, h2, h3, h4, h5, h6 {
    font-weight: var(--font-weight-semibold);
    line-height: 1.3;
    color: var(--color-text-primary);
    margin-bottom: var(--space-md);
}

h1 { font-size: var(--font-size-3xl); }
h2 { font-size: var(--font-size-2xl); }
h3 { font-size: var(--font-size-xl); }
h4 { font-size: var(--font-size-lg); }
h5 { font-size: var(--font-size-base); }
h6 { font-size: var(--font-size-sm); }

p {
    margin-bottom: var(--space-md);
    color: var(--color-text-secondary);
}

a {
    color: var(--color-primary);
    text-decoration: none;
    transition: color var(--transition-fast);
}

a:hover {
    color: var(--color-primary-dark);
    text-decoration: underline;
}

code, pre {
    font-family: var(--font-family-mono);
    font-size: var(--font-size-sm);
}

/* ============================================================================
   4. TOP NAVIGATION BAR
   ============================================================================ */
.dashboard-header {
    position: sticky;
    top: 0;
    z-index: var(--z-sticky);
    background: var(--color-background);
    border-bottom: 1px solid var(--color-border);
    box-shadow: var(--shadow-sm);
}

.header-container {
    max-width: 1920px;
    margin: 0 auto;
    padding: 0 var(--space-xl);
}

.header-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 64px;
}

.header-brand {
    display: flex;
    align-items: center;
    gap: var(--space-md);
}

.brand-logo {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-light));
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-text-inverse);
    font-size: var(--font-size-xl);
}

.brand-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text-primary);
    margin: 0;
}

.brand-subtitle {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    font-weight: var(--font-weight-normal);
    display: block;
    margin-top: -4px;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: var(--space-md);
}

.search-box {
    position: relative;
    width: 320px;
}

.search-input {
    width: 100%;
    height: 40px;
    padding: 0 var(--space-md) 0 var(--space-2xl);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-full);
    font-size: var(--font-size-sm);
    transition: all var(--transition-base);
    background: var(--color-surface);
}

.search-input:focus {
    outline: none;
    border-color: var(--color-primary);
    background: var(--color-background);
    box-shadow: 0 0 0 3px rgba(0, 85, 164, 0.1);
}

.search-icon {
    position: absolute;
    left: var(--space-md);
    top: 50%;
    transform: translateY(-50%);
    color: var(--color-text-muted);
    pointer-events: none;
}

.header-button {
    height: 40px;
    padding: 0 var(--space-lg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-background);
    color: var(--color-text-primary);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all var(--transition-base);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.header-button:hover {
    background: var(--color-surface);
    border-color: var(--color-primary);
}

.header-button.primary {
    background: var(--color-primary);
    border-color: var(--color-primary);
    color: var(--color-text-inverse);
}

.header-button.primary:hover {
    background: var(--color-primary-dark);
    border-color: var(--color-primary-dark);
}

.header-nav {
    border-top: 1px solid var(--color-border-light);
}

.nav-menu {
    display: flex;
    list-style: none;
    gap: var(--space-xs);
    padding: 0;
    margin: 0;
}

.nav-item {
    position: relative;
}

.nav-link {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-md) var(--space-lg);
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    text-decoration: none;
    transition: all var(--transition-base);
    border-bottom: 2px solid transparent;
}

.nav-link:hover {
    color: var(--color-primary);
    background: var(--color-surface);
    text-decoration: none;
}

.nav-link.active {
    color: var(--color-primary);
    border-bottom-color: var(--color-primary);
}

.nav-icon {
    font-size: var(--font-size-base);
}

/* Breadcrumb */
.breadcrumb {
    padding: var(--space-md) var(--space-xl);
    background: var(--color-surface);
    border-bottom: 1px solid var(--color-border-light);
}

.breadcrumb-list {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: var(--font-size-sm);
}

.breadcrumb-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    color: var(--color-text-muted);
}

.breadcrumb-item:not(:last-child)::after {
    content: '/';
    color: var(--color-text-muted);
}

.breadcrumb-link {
    color: var(--color-text-secondary);
    transition: color var(--transition-fast);
}

.breadcrumb-link:hover {
    color: var(--color-primary);
    text-decoration: none;
}

.breadcrumb-item:last-child {
    color: var(--color-text-primary);
    font-weight: var(--font-weight-medium);
}

/* ============================================================================
   5. MAIN LAYOUT
   ============================================================================ */
.dashboard-container {
    max-width: 1920px;
    margin: 0 auto;
    padding: var(--space-xl);
}

.dashboard-grid {
    display: grid;
    gap: var(--space-xl);
}

/* ============================================================================
   6. CARD COMPONENTS
   ============================================================================ */
.card {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    overflow: hidden;
    transition: box-shadow var(--transition-base);
}

.card:hover {
    box-shadow: var(--shadow-md);
}

.card-header {
    padding: var(--space-lg) var(--space-xl);
    border-bottom: 1px solid var(--color-border-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.card-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0;
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.card-title-icon {
    color: var(--color-primary);
}

.card-actions {
    display: flex;
    gap: var(--space-sm);
}

.card-action-button {
    padding: var(--space-sm) var(--space-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: transparent;
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.card-action-button:hover {
    background: var(--color-surface);
    color: var(--color-primary);
    border-color: var(--color-primary);
}

.card-body {
    padding: var(--space-xl);
}

.card-footer {
    padding: var(--space-md) var(--space-xl);
    border-top: 1px solid var(--color-border-light);
    background: var(--color-surface);
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
}

/* ============================================================================
   7. KPI TILES
   ============================================================================ */
.kpi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: var(--space-lg);
    margin-bottom: var(--space-xl);
}

.kpi-card {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-xl);
    box-shadow: var(--shadow-sm);
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
}

.kpi-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--kpi-color, var(--color-primary));
}

.kpi-card:hover {
    box-shadow: var(--shadow-lg);
    transform: translateY(-2px);
}

.kpi-card.success {
    --kpi-color: var(--color-success);
}

.kpi-card.warning {
    --kpi-color: var(--color-warning);
}

.kpi-card.critical {
    --kpi-color: var(--color-critical);
}

.kpi-card.info {
    --kpi-color: var(--color-info);
}

.kpi-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: var(--space-lg);
}

.kpi-icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--font-size-2xl);
    background: var(--kpi-bg, var(--color-info-light));
    color: var(--kpi-color, var(--color-primary));
}

.kpi-card.success .kpi-icon {
    --kpi-bg: var(--color-success-light);
}

.kpi-card.warning .kpi-icon {
    --kpi-bg: var(--color-warning-light);
}

.kpi-card.critical .kpi-icon {
    --kpi-bg: var(--color-critical-light);
}

.kpi-badge {
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    background: var(--kpi-bg);
    color: var(--kpi-color);
}

.kpi-value {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text-primary);
    line-height: 1;
    margin-bottom: var(--space-sm);
}

.kpi-label {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-md);
}

.kpi-trend {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
}

.kpi-trend.up {
    color: var(--color-success);
}

.kpi-trend.down {
    color: var(--color-critical);
}

/* ============================================================================
   8. STATUS BADGES
   ============================================================================ */
.status-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-xs) var(--space-md);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-badge.healthy {
    background: var(--color-success-light);
    color: var(--color-success);
}

.status-badge.warning {
    background: var(--color-warning-light);
    color: #D68910;
}

.status-badge.critical {
    background: var(--color-critical-light);
    color: var(--color-critical);
}

.status-badge.unknown {
    background: #F0F3F7;
    color: var(--color-text-muted);
}

.status-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: currentColor;
}

/* ============================================================================
   9. DATA TABLES
   ============================================================================ */
.data-table-container {
    overflow-x: auto;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--font-size-sm);
}

.data-table thead {
    background: var(--color-surface);
    border-bottom: 2px solid var(--color-border);
}

.data-table th {
    padding: var(--space-md) var(--space-lg);
    text-align: left;
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    white-space: nowrap;
}

.data-table tbody tr {
    border-bottom: 1px solid var(--color-border-light);
    transition: background var(--transition-fast);
}

.data-table tbody tr:hover {
    background: var(--color-surface);
}

.data-table td {
    padding: var(--space-md) var(--space-lg);
    color: var(--color-text-secondary);
}

.data-table td code {
    padding: var(--space-xs) var(--space-sm);
    background: var(--color-surface);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
}

/* ============================================================================
   10. WIDGETS & PANELS
   ============================================================================ */
.widget-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: var(--space-xl);
}

.widget {
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    overflow: hidden;
}

.widget-header {
    padding: var(--space-lg) var(--space-xl);
    border-bottom: 1px solid var(--color-border-light);
    background: var(--color-surface);
}

.widget-title {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0;
}

.widget-body {
    padding: var(--space-xl);
}

/* ============================================================================
   11. CHARTS & VISUALIZATIONS
   ============================================================================ */
.chart-container {
    position: relative;
    width: 100%;
    min-height: 300px;
}

.chart-loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-md);
}

.chart-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid var(--color-border);
    border-top-color: var(--color-primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* ============================================================================
   12. BUTTONS
   ============================================================================ */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    padding: var(--space-sm) var(--space-lg);
    border: 1px solid transparent;
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    font-family: var(--font-family);
    line-height: 1.5;
    cursor: pointer;
    transition: all var(--transition-base);
    text-decoration: none;
    white-space: nowrap;
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.btn-primary {
    background: var(--color-primary);
    color: var(--color-text-inverse);
}

.btn-primary:hover:not(:disabled) {
    background: var(--color-primary-dark);
}

.btn-secondary {
    background: var(--color-surface);
    border-color: var(--color-border);
    color: var(--color-text-primary);
}

.btn-secondary:hover:not(:disabled) {
    background: var(--color-border-light);
    border-color: var(--color-primary);
}

.btn-success {
    background: var(--color-success);
    color: var(--color-text-inverse);
}

.btn-success:hover:not(:disabled) {
    background: #009B7D;
}

.btn-warning {
    background: var(--color-warning);
    color: var(--color-text-primary);
}

.btn-critical {
    background: var(--color-critical);
    color: var(--color-text-inverse);
}

.btn-sm {
    padding: var(--space-xs) var(--space-md);
    font-size: var(--font-size-xs);
}

.btn-lg {
    padding: var(--space-md) var(--space-xl);
    font-size: var(--font-size-base);
}

/* ============================================================================
   13. FILTERS & CONTROLS
   ============================================================================ */
.filter-bar {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-lg);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    margin-bottom: var(--space-xl);
    flex-wrap: wrap;
}

.filter-group {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
}

.filter-label {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text-secondary);
}

.filter-select {
    padding: var(--space-sm) var(--space-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-sm);
    background: var(--color-background);
    color: var(--color-text-primary);
    cursor: pointer;
    transition: all var(--transition-base);
}

.filter-select:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(0, 85, 164, 0.1);
}

/* ============================================================================
   14. RESPONSIVE DESIGN
   ============================================================================ */
@media (max-width: 1200px) {
    .dashboard-container {
        padding: var(--space-lg);
    }
    
    .kpi-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    
    .widget-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .header-container {
        padding: 0 var(--space-md);
    }
    
    .header-top {
        height: 56px;
    }
    
    .brand-title {
        font-size: var(--font-size-lg);
    }
    
    .search-box {
        width: 200px;
    }
    
    .nav-menu {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    .nav-link {
        padding: var(--space-sm) var(--space-md);
    }
    
    .dashboard-container {
        padding: var(--space-md);
    }
    
    .kpi-grid {
        grid-template-columns: 1fr;
    }
    
    .kpi-value {
        font-size: var(--font-size-3xl);
    }
    
    .card-header,
    .card-body {
        padding: var(--space-md);
    }
    
    .filter-bar {
        flex-direction: column;
        align-items: stretch;
    }
}

@media (max-width: 480px) {
    .header-actions {
        gap: var(--space-sm);
    }
    
    .search-box {
        display: none;
    }
    
    .header-button {
        padding: 0 var(--space-md);
    }
    
    .breadcrumb {
        padding: var(--space-sm) var(--space-md);
    }
    
    .kpi-card {
        padding: var(--space-md);
    }
    
    .kpi-icon {
        width: 40px;
        height: 40px;
        font-size: var(--font-size-xl);
    }
    
    .kpi-value {
        font-size: var(--font-size-2xl);
    }
}

/* ============================================================================
   15. UTILITY CLASSES
   ============================================================================ */
.text-center { text-align: center; }
.text-right { text-align: right; }
.text-muted { color: var(--color-text-muted); }
.text-primary { color: var(--color-primary); }
.text-success { color: var(--color-success); }
.text-warning { color: var(--color-warning); }
.text-critical { color: var(--color-critical); }

.mb-0 { margin-bottom: 0; }
.mb-sm { margin-bottom: var(--space-sm); }
.mb-md { margin-bottom: var(--space-md); }
.mb-lg { margin-bottom: var(--space-lg); }
.mb-xl { margin-bottom: var(--space-xl); }

.mt-0 { margin-top: 0; }
.mt-sm { margin-top: var(--space-sm); }
.mt-md { margin-top: var(--space-md); }
.mt-lg { margin-top: var(--space-lg); }
.mt-xl { margin-top: var(--space-xl); }

.d-flex { display: flex; }
.d-grid { display: grid; }
.d-none { display: none; }
.d-block { display: block; }

.align-center { align-items: center; }
.justify-between { justify-content: space-between; }
.gap-sm { gap: var(--space-sm); }
.gap-md { gap: var(--space-md); }
.gap-lg { gap: var(--space-lg); }

/* ============================================================================
   16. TCP CONNECTION ANALYSIS STYLES
   ============================================================================ */

/* TCP Status Badges */
.tcp-status-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
    font-weight: 600;
    white-space: nowrap;
}

.tcp-status-success {
    background-color: #d4edda;
    color: #155724;
}

.tcp-status-failed {
    background-color: #f8d7da;
    color: #721c24;
}

.tcp-status-partial {
    background-color: #fff3cd;
    color: #856404;
}

/* Row highlighting based on status */
.status-row-success {
    background-color: rgba(0, 184, 148, 0.05);
}

.status-row-success:hover {
    background-color: rgba(0, 184, 148, 0.1);
}

.status-row-failed {
    background-color: rgba(225, 112, 85, 0.08);
}

.status-row-failed:hover {
    background-color: rgba(225, 112, 85, 0.15);
}

.status-row-partial {
    background-color: rgba(253, 203, 110, 0.08);
}

.status-row-partial:hover {
    background-color: rgba(253, 203, 110, 0.15);
}

/* Copy Filter Button */
.copy-filter-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    padding: 0;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: var(--color-background);
    color: var(--color-text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
}

.copy-filter-btn:hover {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
}

.copy-filter-btn:active {
    transform: scale(0.95);
}

/* Wireshark Filter Code */
.wireshark-filter {
    background: var(--color-surface);
    padding: 4px 8px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--color-border);
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
    white-space: nowrap;
}

/* ============================================================================
   17. PRINT STYLES
   ============================================================================ */
@media print {
    .dashboard-header,
    .breadcrumb,
    .filter-bar,
    .card-actions,
    .header-button {
        display: none;
    }
    
    .card {
        break-inside: avoid;
        box-shadow: none;
        border: 1px solid #ddd;
    }
    
    body {
        background: white;
    }
}
</style>
</head>
<body>
    
    <header class="dashboard-header">
        <div class="header-container">
            
            <div class="header-top">
                
                <div class="header-brand">
                    <div class="brand-logo">
                        <i class="fas fa-network-wired"></i>
                    </div>
                    <div>
                        <h1 class="brand-title">
                            SD-WAN Network Triage
                            <span class="brand-subtitle">v2.7.0 - Enterprise Dashboard</span>
                        </h1>
                    </div>
                </div>
                
                
                <div class="header-actions">
                    
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" id="globalSearch" placeholder="Search IPs, devices, events...">
                    </div>
                    
                    
                    <button class="header-button" onclick="window.print()">
                        <i class="fas fa-download"></i>
                        <span>Export PDF</span>
                    </button>
                    
                    
                    <button class="header-button primary" onclick="location.reload()">
                        <i class="fas fa-sync-alt"></i>
                        <span>Refresh</span>
                    </button>
                </div>
            </div>
            
            
            <nav class="header-nav">
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#dashboard" class="nav-link active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt nav-icon"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#security" class="nav-link" data-section="security">
                            <i class="fas fa-shield-alt nav-icon"></i>
                            <span>Security</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#performance" class="nav-link" data-section="performance">
                            <i class="fas fa-chart-line nav-icon"></i>
                            <span>Performance</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#traffic" class="nav-link" data-section="traffic">
                            <i class="fas fa-exchange-alt nav-icon"></i>
                            <span>Traffic</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#protocols" class="nav-link" data-section="protocols">
                            <i class="fas fa-layer-group nav-icon"></i>
                            <span>Protocols</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#tunnels" class="nav-link" data-section="tunnels">
                            <i class="fas fa-network-wired nav-icon"></i>
                            <span>Tunnels & SD-WAN</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#visualizations" class="nav-link" data-section="visualizations">
                            <i class="fas fa-project-diagram nav-icon"></i>
                            <span>Visualizations</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#devices" class="nav-link" data-section="devices">
                            <i class="fas fa-laptop nav-icon"></i>
                            <span>Devices</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    
    
    <div class="breadcrumb">
        <ul class="breadcrumb-list">
            <li class="breadcrumb-item">
                <a href="#" class="breadcrumb-link">Home</a>
            </li>
            <li class="breadcrumb-item" id="currentSection">Dashboard</li>
        </ul>
    </div>
    
    
    <main class="dashboard-container">
        
        
        <section id="dashboard" class="dashboard-section">
            <div class="kpi-grid">
                
                <div class="kpi-card critical">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <span class="kpi-badge">
                            Critical
                        </span>
                    </div>
                    <div class="kpi-value">Critical</div>
                    <div class="kpi-label">Network Health Status</div>
                    <div class="kpi-trend">
                        <i class="fas fa-info-circle"></i>
                        <span>Based on 8 findings</span>
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-handshake-slash"></i>
                        </div>
                        
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">Failed TCP Handshakes</div>
                    <div class="kpi-trend ">
                        
                        <i class="fas fa-check-circle"></i>
                        <span>All connections successful</span>
                        
                    </div>
                </div>
                
                
                <div class="kpi-card critical">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        
                        <span class="kpi-badge">!</span>
                        
                    </div>
                    <div class="kpi-value">8</div>
                    <div class="kpi-label">Security Threats</div>
                    <div class="kpi-trend">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>DDoS: 8 | Scans: 0 | IOCs: 0 | BGP: 0</span>
                    </div>
                </div>
                
                
                <div class="kpi-card info">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">TCP Retransmissions</div>
                    <div class="kpi-trend">
                        <i class="fas fa-clock"></i>
                        <span>High RTT: 0 | HTTP Errors: 0</span>
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-network-wired"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">Tunnels Detected</div>
                    <div class="kpi-trend">
                        <i class="fas fa-info-circle"></i>
                        <span>VXLAN, GRE, IPsec, etc.</span>
                    </div>
                </div>
                
                
                <div class="kpi-card info">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-sitemap"></i>
                        </div>
                    </div>
                    <div class="kpi-value">1</div>
                    <div class="kpi-label">SD-WAN Vendors</div>
                    <div class="kpi-trend">
                        <i class="fas fa-fingerprint"></i>
                        <span>Detected vendor signatures</span>
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-phone-volume"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">VoIP Calls</div>
                    <div class="kpi-trend">
                        <i class="fas fa-info-circle"></i>
                        <span>SIP/RTP sessions detected</span>
                    </div>
                </div>
                
                
                <div class="kpi-card info">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-globe"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">DNS Queries</div>
                    <div class="kpi-trend ">
                        
                        <i class="fas fa-check-circle"></i>
                        <span>No anomalies detected</span>
                        
                    </div>
                </div>
                
                
                <div class="kpi-card success">
                    <div class="kpi-header">
                        <div class="kpi-icon">
                            <i class="fas fa-laptop"></i>
                        </div>
                    </div>
                    <div class="kpi-value">0</div>
                    <div class="kpi-label">Devices Identified</div>
                    <div class="kpi-trend">
                        <i class="fas fa-fingerprint"></i>
                        <span>ARP Conflicts: 0</span>
                    </div>
                </div>
            </div>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="fas fa-clipboard-list card-title-icon"></i>
                        Executive Summary
                    </h2>
                    <div class="card-actions">
                        <button class="card-action-button" onclick="toggleSection('executive-summary')">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body" id="executive-summary">
                    <div class="dashboard-grid" style="grid-template-columns: 2fr 1fr; gap: var(--space-xl);">
                        
                        <div>
                            <h3 class="mb-md">Analysis Overview</h3>
                            <p class="text-muted mb-lg">
                                Analyzed <strong>banco.pcap</strong> containing <strong>0 packets</strong> 
                                on <strong>2026-01-13 13:35:04</strong>.
                            </p>
                            
                            
                            <div class="mb-lg">
                                <div class="executive-summary-explanation">
		<p class="info-box">
			<i class="fas fa-info-circle"></i>
			<strong>About this Summary:</strong> This executive summary provides a high-level overview of your network's health based on analysis of the captured traffic. 
			The <strong>Risk Level</strong> indicates the overall severity of findings detected (Low, Medium, High, or Critical), calculated from the number and type of security issues, performance problems, and anomalies found. 
			The counters below highlight the most significant categories of issues that require attention. Use this summary to quickly assess network health and prioritize troubleshooting efforts.
		</p>
	</div>
                            </div>
                            
                            
                            
                            <h4 class="mb-md">Key Findings</h4>
                            <div class="d-grid gap-md mb-lg">
                                
                                <div class="status-badge critical">
                                    <span class="status-dot"></span>
                                    <span>8 DDoS Attack(s) Detected</span>
                                </div>
                                
                                
                                
                                
                                
                                
                                
                                
                                
                            </div>
                        </div>
                        
                        
                        <div>
                            <div class="card" style="background: var(--color-surface); border: none;">
                                <div class="card-body">
                                    <h4 class="mb-md">Risk Assessment</h4>
                                    <div class="text-center mb-lg">
                                        <div class="kpi-value" style="font-size: var(--font-size-4xl); color: var(--color-critical);">
                                            80
                                        </div>
                                        <div class="kpi-label">Risk Score</div>
                                        <span class="status-badge critical">
                                            <span class="status-dot"></span>
                                            Critical Risk
                                        </span>
                                    </div>
                                    
                                    
                                    <h5 class="mb-sm">Recommended Actions</h5>
                                    <ul style="padding-left: var(--space-lg); margin: 0; font-size: var(--font-size-sm); color: var(--color-text-secondary);">
                                        
                                        <li style="margin-bottom: var(--space-sm);">CRITICAL: Potential DDoS attack detected. Enable rate limiting and contact your ISP if needed.</li>
                                        
                                    </ul>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <i class="fas fa-clock"></i> Last updated: 2026-01-13 13:35:04
                </div>
            </div>
        </section>
        
        
        <section id="security" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-shield-alt" style="color: var(--color-primary);"></i>
                Security Analysis
            </h2>
            
            
            <div class="widget-grid mb-xl">
                
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-bomb" style="color: var(--color-critical);"></i>
                            DDoS Attacks (8)
                        </h3>
                    </div>
                    <div class="widget-body">
                        
                        <div class="data-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Type</th>
                                        <th>Source IP</th>
                                        <th>Target IP</th>
                                        <th>Packet Count</th>
                                        <th>Severity</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    
                                    <tr>
                                        <td><code>UDP Flood</code></td>
                                        <td><code>172.27.255.25</code></td>
                                        <td><code>172.27.255.57</code></td>
                                        <td>200</td>
                                        <td>
                                            <span class="status-badge critical">
                                                <span class="status-dot"></span>
                                                High
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td><code>UDP Flood</code></td>
                                        <td><code>172.27.255.57</code></td>
                                        <td><code>172.27.255.29</code></td>
                                        <td>200</td>
                                        <td>
                                            <span class="status-badge critical">
                                                <span class="status-dot"></span>
                                                High
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td><code>UDP Flood</code></td>
                                        <td><code>172.27.255.1</code></td>
                                        <td><code>172.27.255.57</code></td>
                                        <td>200</td>
                                        <td>
                                            <span class="status-badge critical">
                                                <span class="status-dot"></span>
                                                High
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td><code>UDP Flood</code></td>
                                        <td><code>172.27.255.29</code></td>
                                        <td><code>172.27.255.57</code></td>
                                        <td>200</td>
                                        <td>
                                            <span class="status-badge critical">
                                                <span class="status-dot"></span>
                                                High
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td><code>UDP Flood</code></td>
                                        <td><code>172.27.255.33</code></td>
                                        <td><code>172.27.255.57</code></td>
                                        <td>200</td>
                                        <td>
                                            <span class="status-badge critical">
                                                <span class="status-dot"></span>
                                                High
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td><code>UDP Flood</code></td>
                                        <td><code>172.27.255.49</code></td>
                                        <td><code>172.27.255.57</code></td>
                                        <td>200</td>
                                        <td>
                                            <span class="status-badge critical">
                                                <span class="status-dot"></span>
                                                High
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td><code>UDP Flood</code></td>
                                        <td><code>172.27.255.53</code></td>
                                        <td><code>172.27.255.57</code></td>
                                        <td>200</td>
                                        <td>
                                            <span class="status-badge critical">
                                                <span class="status-dot"></span>
                                                High
                                            </span>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td><code>UDP Flood</code></td>
                                        <td><code>172.27.255.93</code></td>
                                        <td><code>172.27.255.57</code></td>
                                        <td>200</td>
                                        <td>
                                            <span class="status-badge critical">
                                                <span class="status-dot"></span>
                                                High
                                            </span>
                                        </td>
                                    </tr>
                                    
                                </tbody>
                            </table>
                        </div>
                        
                    </div>
                </div>
                
                
                
                
                
                
                
                
                
                
                
                
                
            </div>
            
            
            
            
            
            
        </section>
        
        
        <section id="performance" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-chart-line" style="color: var(--color-primary);"></i>
                Performance Analysis
            </h2>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-handshake card-title-icon"></i>
                        TCP Connection Analysis - Per-Flow Breakdown
                    </h3>
                    <div class="card-actions">
                        <span class="status-badge healthy">
                            <span class="status-dot"></span>
                            0 Success / 0 Failed
                        </span>
                    </div>
                </div>
                <div class="card-body">
                    
                    <div class="dashboard-grid" style="grid-template-columns: repeat(4, 1fr); gap: var(--space-md); margin-bottom: var(--space-xl);">
                        <div style="text-align: center; padding: var(--space-md); background: var(--color-surface); border-radius: var(--radius-md); border-left: 4px solid var(--color-info);">
                            <div style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-info);">0</div>
                            <div style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Total SYN</div>
                        </div>
                        <div style="text-align: center; padding: var(--space-md); background: var(--color-surface); border-radius: var(--radius-md); border-left: 4px solid var(--color-success);">
                            <div style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-success);">0</div>
                            <div style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Total SYN-ACK</div>
                        </div>
                        <div style="text-align: center; padding: var(--space-md); background: var(--color-surface); border-radius: var(--radius-md); border-left: 4px solid var(--color-success);">
                            <div style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-success);">0</div>
                            <div style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Successful</div>
                        </div>
                        <div style="text-align: center; padding: var(--space-md); background: var(--color-surface); border-radius: var(--radius-md); border-left: 4px solid var(--color-success);">
                            <div style="font-size: var(--font-size-2xl); font-weight: 700; color: var(--color-success);">0</div>
                            <div style="font-size: var(--font-size-xs); color: var(--color-text-muted);">Failed</div>
                        </div>
                    </div>
                    
                    
                    
                    <div style="text-align: center; padding: var(--space-xl); color: var(--color-text-muted);">
                        <i class="fas fa-info-circle" style="font-size: var(--font-size-2xl); margin-bottom: var(--space-md);"></i>
                        <p>No TCP handshake flows recorded in this capture.</p>
                    </div>
                    
                    
                    
                    <div style="background: rgba(0, 184, 148, 0.1); border-left: 4px solid var(--color-success); padding: var(--space-lg); border-radius: var(--radius-md);">
                        <h4 style="margin: 0 0 var(--space-sm) 0; color: var(--color-success);">
                            <i class="fas fa-check-circle"></i> All Connections Successful
                        </h4>
                        <p style="margin: 0; color: var(--color-text-secondary); font-size: var(--font-size-sm);">
                            All TCP connection attempts successfully completed the three-way handshake. No unreachable services detected.
                        </p>
                    </div>
                    
                </div>
            </div>
            
            
            
            
            
            <div class="widget-grid mb-xl">
                
                
                
            </div>
            
            
            <div class="widget-grid mb-xl">
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-redo" style="color: var(--color-warning);"></i>
                            TCP Retransmissions
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl); margin-bottom: var(--space-md);">
                            0
                        </div>
                        <p class="text-muted mb-md">Total retransmission events detected</p>
                        
                        <div class="status-badge healthy">
                            <span class="status-dot"></span>
                            Normal retransmission rate
                        </div>
                        
                    </div>
                </div>
                
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-clock" style="color: var(--color-info);"></i>
                            High Latency Flows
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl); margin-bottom: var(--space-md);">
                            0
                        </div>
                        <p class="text-muted mb-md">Flows with elevated round-trip time</p>
                        
                        <div class="status-badge healthy">
                            <span class="status-dot"></span>
                            Latency within acceptable range
                        </div>
                        
                    </div>
                </div>
            </div>
            
            
            
            
            
            
        </section>
        
        
        <section id="traffic" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-exchange-alt" style="color: var(--color-primary);"></i>
                Traffic Analysis
            </h2>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-chart-bar card-title-icon"></i>
                        Top Traffic Flows
                    </h3>
                </div>
                <div class="card-body">
                    
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Source IP:Port</th>
                                    <th>Destination IP:Port</th>
                                    <th>Protocol</th>
                                    <th>Total Bytes</th>
                                    <th>Percentage</th>
                                </tr>
                            </thead>
                            <tbody>
                                
                                <tr>
                                    <td><code>172.27.255.25:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>13.3 MB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 66.6%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">66.6%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.29:2426</code></td>
                                    <td>TCP</td>
                                    <td>2.3 MB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 11.6%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">11.6%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.25:2426</code></td>
                                    <td>TCP</td>
                                    <td>1.3 MB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 6.4%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">6.4%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.1:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>1020.9 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 5.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">5.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.1:2426</code></td>
                                    <td>TCP</td>
                                    <td>960.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 4.7%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">4.7%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.29:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>531.7 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 2.6%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">2.6%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.93:2426</code></td>
                                    <td>TCP</td>
                                    <td>145.9 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.7%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.7%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.93:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>142.1 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.7%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.7%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.33:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>38.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.2%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.2%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.33:2426</code></td>
                                    <td>TCP</td>
                                    <td>37.3 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.2%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.2%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.69:2426</code></td>
                                    <td>TCP</td>
                                    <td>30.5 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.1%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.1%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.53:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>27.4 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.1%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.1%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.53:2426</code></td>
                                    <td>TCP</td>
                                    <td>27.4 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.1%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.1%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.49:2426</code></td>
                                    <td>TCP</td>
                                    <td>23.7 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.1%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.1%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.49:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>23.7 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.1%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.1%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.5:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>12.4 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.1%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.1%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.5:2426</code></td>
                                    <td>TCP</td>
                                    <td>12.0 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.1%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.1%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>103.48.253.62:2426</code></td>
                                    <td>TCP</td>
                                    <td>10.0 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>152.65.246.16:2426</code></td>
                                    <td>TCP</td>
                                    <td>9.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>152.65.246.16:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>8.3 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.37:2426</code></td>
                                    <td>TCP</td>
                                    <td>8.0 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>103.48.253.62:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>7.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.37:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.7 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.13:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.4 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>136.144.103.35:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.4 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>152.65.255.42:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.4 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.69:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.3 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.85:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.3 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>136.144.103.35:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>152.65.255.42:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.13:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.85:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td><code>172.27.255.21:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td><code>172.27.255.21:2426</code></td>
                                    <td><code>172.27.255.57:2426</code></td>
                                    <td>TCP</td>
                                    <td>6.2 KB</td>
                                    <td>
                                        <div style="display: flex; align-items: center; gap: var(--space-sm);">
                                            <div style="flex: 1; height: 8px; background: var(--color-border); border-radius: var(--radius-full); overflow: hidden;">
                                                <div style="width: 0.0%; height: 100%; background: var(--color-primary);"></div>
                                            </div>
                                            <span style="min-width: 50px; text-align: right;">0.0%</span>
                                        </div>
                                    </td>
                                </tr>
                                
                            </tbody>
                        </table>
                    </div>
                    
                </div>
            </div>
            
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-layer-group card-title-icon"></i>
                        Protocol Distribution
                    </h3>
                </div>
                <div class="card-body">
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Protocol</th>
                                    <th>Total Bytes</th>
                                    <th>Percentage</th>
                                </tr>
                            </thead>
                            <tbody>
                                
                                <tr>
                                    <td><strong>UDP</strong></td>
                                    <td>20989897</td>
                                    <td>100.0%</td>
                                </tr>
                                
                                <tr>
                                    <td><strong></strong></td>
                                    <td>792</td>
                                    <td>0.0%</td>
                                </tr>
                                
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
        </section>
        
        
        <section id="protocols" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-layer-group" style="color: var(--color-primary);"></i>
                Protocol Analysis
            </h2>
            
            
            <div class="widget-grid mb-xl">
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-globe"></i>
                            DNS Queries
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl);">0</div>
                        <p class="text-muted">Total DNS queries processed</p>
                    </div>
                </div>
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-bolt"></i>
                            HTTP/2 Flows
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl);">0</div>
                        <p class="text-muted">Modern HTTP/2 connections</p>
                    </div>
                </div>
                
                <div class="widget">
                    <div class="widget-header">
                        <h3 class="widget-title">
                            <i class="fas fa-rocket"></i>
                            QUIC Flows
                        </h3>
                    </div>
                    <div class="widget-body">
                        <div class="kpi-value" style="font-size: var(--font-size-3xl);">0</div>
                        <p class="text-muted">QUIC protocol connections</p>
                    </div>
                </div>
            </div>
            
            
            
            <div class="card mb-xl">
                <div class="card-body">
                    <div style="text-align: center; padding: var(--space-xl); color: var(--color-text-muted);">
                        <i class="fas fa-info-circle" style="font-size: var(--font-size-3xl); margin-bottom: var(--space-md);"></i>
                        <p>No DNS queries recorded in this capture.</p>
                    </div>
                </div>
            </div>
            
            
            
            
            
            
            
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-book card-title-icon"></i>
                        Protocol Reference Guide
                    </h3>
                </div>
                <div class="card-body">
                    
		<div class="protocol-guide">
			<details class="guide-section">
				<summary><i class="fas fa-book-open"></i> Protocol Analysis Guide</summary>
				<div class="guide-content">
					<h4>Understanding Network Protocols</h4>
					
					<div class="protocol-explanation">
						<h5><i class="fas fa-exchange-alt"></i> TCP Handshakes</h5>
						<p><strong>Normal Behavior:</strong> TCP uses a three-way handshake to establish connections:</p>
						<ol>
							<li><strong>SYN:</strong> Client sends SYN packet to server</li>
							<li><strong>SYN-ACK:</strong> Server responds with SYN-ACK</li>
							<li><strong>ACK:</strong> Client sends final ACK to complete handshake</li>
						</ol>
						<p><strong>Abnormal Behavior:</strong> Failed handshakes occur when SYN packets receive no response (server down/firewalled) or receive RST (connection refused).</p>
						<p><strong>Wireshark Filters:</strong></p>
						<ul>
							<li><code>tcp.flags.syn == 1 and tcp.flags.ack == 0</code> - See SYN packets (connection attempts)</li>
							<li><code>tcp.flags.syn == 1 and tcp.flags.ack == 1</code> - See SYN-ACK packets (server responses)</li>
							<li><code>tcp.flags.reset == 1</code> - See RST packets (connection refused/aborted)</li>
							<li><code>tcp.analysis.flags</code> - See TCP analysis flags (retransmissions, out-of-order, etc.)</li>
						</ul>
					</div>
					
					<div class="protocol-explanation">
						<h5><i class="fas fa-globe"></i> HTTP/HTTPS</h5>
						<p><strong>Normal Behavior:</strong> HTTP requests receive 2xx (success) or 3xx (redirect) responses.</p>
						<p><strong>Abnormal Behavior:</strong> 4xx errors indicate client-side issues (404 Not Found, 403 Forbidden). 5xx errors indicate server-side failures (500 Internal Server Error, 503 Service Unavailable).</p>
						<p><strong>Wireshark Filters:</strong></p>
						<ul>
							<li><code>http.response.code >= 400</code> - See all HTTP errors</li>
							<li><code>http.response.code >= 500</code> - See server errors only</li>
							<li><code>http.request.method == "GET"</code> - See GET requests</li>
							<li><code>http.request.method == "POST"</code> - See POST requests</li>
							<li><code>ssl.handshake.type == 1</code> - See HTTPS ClientHello packets</li>
						</ul>
					</div>
					
					<div class="protocol-explanation">
						<h5><i class="fas fa-search"></i> DNS</h5>
						<p><strong>Normal Behavior:</strong> DNS queries receive responses with answer records. Response time is typically under 100ms.</p>
						<p><strong>Abnormal Behavior:</strong> NXDOMAIN (domain doesn't exist), timeouts (no response), excessive queries to random domains (DGA malware), or queries to suspicious domains.</p>
						<p><strong>Wireshark Filters:</strong></p>
						<ul>
							<li><code>dns.flags.response == 0</code> - See DNS queries</li>
							<li><code>dns.flags.response == 1</code> - See DNS responses</li>
							<li><code>dns.flags.rcode == 3</code> - See NXDOMAIN responses</li>
							<li><code>dns.time > 1</code> - See slow DNS responses (>1 second)</li>
							<li><code>dns.qry.name contains "suspicious"</code> - Search for specific domains</li>
						</ul>
					</div>
					
					<div class="protocol-explanation">
						<h5><i class="fas fa-network-wired"></i> ARP</h5>
						<p><strong>Normal Behavior:</strong> ARP requests receive a single response mapping an IP to a MAC address.</p>
						<p><strong>Abnormal Behavior:</strong> Multiple MAC addresses claiming the same IP (conflict), excessive ARP requests (scanning), or gratuitous ARP from unexpected sources (spoofing).</p>
						<p><strong>Wireshark Filters:</strong></p>
						<ul>
							<li><code>arp.opcode == 1</code> - See ARP requests (who-has)</li>
							<li><code>arp.opcode == 2</code> - See ARP replies (is-at)</li>
							<li><code>arp.duplicate-address-detected</code> - See ARP conflicts</li>
							<li><code>arp.src.proto_ipv4 == 192.168.1.1</code> - See ARP for specific IP</li>
						</ul>
					</div>
				</div>
			</details>
		</div>
	
                </div>
            </div>
            
        </section>
        
        
        <section id="tunnels" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-network-wired" style="color: var(--color-primary);"></i>
                Tunnels & SD-WAN Analysis
            </h2>
            
            
            
            <div class="card mb-xl">
                <div class="card-body">
                    <div style="text-align: center; padding: var(--space-xl); color: var(--color-text-muted);">
                        <i class="fas fa-info-circle" style="font-size: var(--font-size-3xl); margin-bottom: var(--space-md);"></i>
                        <p>No tunnels detected in this capture.</p>
                    </div>
                </div>
            </div>
            
            
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-sitemap card-title-icon"></i>
                        SD-WAN Vendors Detected (1)
                    </h3>
                </div>
                <div class="card-body">
                    
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Vendor</th>
                                    <th>Detected By</th>
                                    <th>Packet Count</th>
                                    <th>Confidence</th>
                                </tr>
                            </thead>
                            <tbody>
                                
                                <tr>
                                    <td><strong>VMware SD-WAN (VeloCloud)</strong></td>
                                    <td>Port Match</td>
                                    <td>68894 packets</td>
                                    <td>
                                        <span class="status-badge warning">
                                            <span class="status-dot"></span>
                                            Medium
                                        </span>
                                    </td>
                                </tr>
                                
                            </tbody>
                        </table>
                    </div>
                    
                </div>
            </div>
            
            
            
            
            
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-globe-americas card-title-icon"></i>
                        Geographic Distribution
                    </h3>
                </div>
                <div class="card-body">
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Country</th>
                                    <th>IP Count</th>
                                    <th colspan="2">Details</th>
                                </tr>
                            </thead>
                            <tbody>
                                
                                <tr>
                                    <td><strong>Unknown (Class B)</strong></td>
                                    <td>3</td>
                                    <td colspan="2">-</td>
                                </tr>
                                
                                <tr>
                                    <td><strong>Unknown (Class A)</strong></td>
                                    <td>1</td>
                                    <td colspan="2">-</td>
                                </tr>
                                
                                <tr>
                                    <td><strong>Unknown (IPv6)</strong></td>
                                    <td>1</td>
                                    <td colspan="2">-</td>
                                </tr>
                                
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
        </section>
        
        
        <section id="visualizations" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-project-diagram" style="color: var(--color-primary);"></i>
                Network Visualizations
            </h2>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-network-wired card-title-icon"></i>
                        Network Topology
                    </h3>
                    <div class="card-actions">
                        <button class="card-action-button" onclick="resetTopology()">
                            <i class="fas fa-sync-alt"></i> Reset
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="network-diagram" class="chart-container" style="min-height: 600px; background: #ffffff; border: 1px solid var(--color-border); border-radius: var(--radius-md); position: relative;"></div>
                </div>
            </div>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-timeline card-title-icon"></i>
                        Event Timeline
                    </h3>
                </div>
                <div class="card-body">
                    <div id="timeline" class="chart-container"></div>
                </div>
            </div>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-stream card-title-icon"></i>
                        Traffic Flow Diagram
                    </h3>
                </div>
                <div class="card-body">
                    <div id="sankey-diagram" class="chart-container"></div>
                </div>
            </div>
            
            
            <div class="card mb-xl">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-chart-bar card-title-icon"></i>
                        RTT Distribution
                    </h3>
                </div>
                <div class="card-body">
                    <div id="rtt-histogram" class="chart-container"></div>
                </div>
            </div>
        </section>
        
        
        <section id="devices" class="dashboard-section" style="display: none;">
            <h2 class="mb-xl">
                <i class="fas fa-laptop" style="color: var(--color-primary);"></i>
                Device Fingerprinting
            </h2>
            
            
            <div class="card">
                <div class="card-body">
                    <p class="text-muted text-center">No devices fingerprinted.</p>
                </div>
            </div>
            
        </section>
        
    </main>
    
    
    <script>
        
        const networkData = {"links":[{"hasIssue":false,"packets":9325,"protocol":"TCP","source":"172.27.255.25","target":"172.27.255.57","value":13988818},{"hasIssue":false,"packets":1617,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.29","value":2425789},{"hasIssue":false,"packets":898,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.25","value":1347840},{"hasIssue":false,"packets":696,"protocol":"TCP","source":"172.27.255.1","target":"172.27.255.57","value":1045397},{"hasIssue":false,"packets":655,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.1","value":983206},{"hasIssue":false,"packets":362,"protocol":"TCP","source":"172.27.255.29","target":"172.27.255.57","value":544460},{"hasIssue":false,"packets":99,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.93","value":149426},{"hasIssue":false,"packets":96,"protocol":"TCP","source":"172.27.255.93","target":"172.27.255.57","value":145497},{"hasIssue":false,"packets":26,"protocol":"TCP","source":"172.27.255.33","target":"172.27.255.57","value":39140},{"hasIssue":false,"packets":25,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.33","value":38200},{"hasIssue":false,"packets":20,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.69","value":31245},{"hasIssue":false,"packets":18,"protocol":"TCP","source":"172.27.255.53","target":"172.27.255.57","value":28023},{"hasIssue":false,"packets":18,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.53","value":28023},{"hasIssue":false,"packets":16,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.49","value":24260},{"hasIssue":false,"packets":16,"protocol":"TCP","source":"172.27.255.49","target":"172.27.255.57","value":24239},{"hasIssue":false,"packets":8,"protocol":"TCP","source":"172.27.255.5","target":"172.27.255.57","value":12735},{"hasIssue":false,"packets":8,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.5","value":12288},{"hasIssue":false,"packets":6,"protocol":"TCP","source":"172.27.255.57","target":"103.48.253.62","value":10214},{"hasIssue":false,"packets":6,"protocol":"TCP","source":"172.27.255.57","target":"152.65.246.16","value":9441},{"hasIssue":false,"packets":5,"protocol":"TCP","source":"152.65.246.16","target":"172.27.255.57","value":8493},{"hasIssue":false,"packets":5,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.37","value":8184},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"103.48.253.62","target":"172.27.255.57","value":7392},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.37","target":"172.27.255.57","value":6833},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.13","value":6542},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.57","target":"136.144.103.35","value":6522},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.57","target":"152.65.255.42","value":6522},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.69","target":"172.27.255.57","value":6493},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.85","value":6414},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"136.144.103.35","target":"172.27.255.57","value":6395},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"152.65.255.42","target":"172.27.255.57","value":6395},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.13","target":"172.27.255.57","value":6385},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.85","target":"172.27.255.57","value":6385},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.57","target":"172.27.255.21","value":6365},{"hasIssue":false,"packets":4,"protocol":"TCP","source":"172.27.255.21","target":"172.27.255.57","value":6336}],"nodes":[{"bytes":77340,"connections":2,"group":"anomaly","hasIssue":true,"id":"172.27.255.33","label":"172.27.255.33"},{"bytes":48499,"connections":2,"group":"anomaly","hasIssue":true,"id":"172.27.255.49","label":"172.27.255.49"},{"bytes":17606,"connections":2,"group":"external","id":"103.48.253.62","label":"103.48.253.62"},{"bytes":12701,"connections":2,"group":"internal","id":"172.27.255.21","label":"172.27.255.21"},{"bytes":15336658,"connections":2,"group":"anomaly","hasIssue":true,"id":"172.27.255.25","label":"172.27.255.25"},{"bytes":20989897,"connections":34,"group":"anomaly","hasIssue":true,"id":"172.27.255.57","label":"172.27.255.57"},{"bytes":2970249,"connections":2,"group":"anomaly","hasIssue":true,"id":"172.27.255.29","label":"172.27.255.29"},{"bytes":12927,"connections":2,"group":"internal","id":"172.27.255.13","label":"172.27.255.13"},{"bytes":12917,"connections":2,"group":"external","id":"152.65.255.42","label":"152.65.255.42"},{"bytes":2028603,"connections":2,"group":"anomaly","hasIssue":true,"id":"172.27.255.1","label":"172.27.255.1"},{"bytes":37738,"connections":2,"group":"internal","id":"172.27.255.69","label":"172.27.255.69"},{"bytes":56046,"connections":2,"group":"anomaly","hasIssue":true,"id":"172.27.255.53","label":"172.27.255.53"},{"bytes":25023,"connections":2,"group":"internal","id":"172.27.255.5","label":"172.27.255.5"},{"bytes":17934,"connections":2,"group":"external","id":"152.65.246.16","label":"152.65.246.16"},{"bytes":294923,"connections":2,"group":"anomaly","hasIssue":true,"id":"172.27.255.93","label":"172.27.255.93"},{"bytes":15017,"connections":2,"group":"internal","id":"172.27.255.37","label":"172.27.255.37"},{"bytes":12917,"connections":2,"group":"external","id":"136.144.103.35","label":"136.144.103.35"},{"bytes":12799,"connections":2,"group":"internal","id":"172.27.255.85","label":"172.27.255.85"}]};
        const timelineData = [];
        const sankeyData = {"links":[{"source":0,"target":1,"value":20989897},{"source":1,"target":2,"value":20989897}],"nodes":[{"name":"Internal Network"},{"name":"Gateway"},{"name":"Internet"}]};
        const rttHistogramData = [{"bucket":"0-10ms","count":0},{"bucket":"10-50ms","count":0},{"bucket":"50-100ms","count":0},{"bucket":"100-200ms","count":0},{"bucket":"200-500ms","count":0},{"bucket":"500-1000ms","count":0},{"bucket":"1000ms+","count":0}];
        
        
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                
                const section = this.dataset.section;
                document.querySelectorAll('.dashboard-section').forEach(s => s.style.display = 'none');
                document.getElementById(section).style.display = 'block';
                
                
                document.getElementById('currentSection').textContent = this.textContent.trim();
                
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        
        
        document.getElementById('globalSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            
            
            document.querySelectorAll('.data-table tbody tr').forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });
        
        
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            const button = event.target.closest('button');
            const icon = button.querySelector('i');
            
            if (section.style.display === 'none') {
                section.style.display = 'block';
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            } else {
                section.style.display = 'none';
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            }
        }
        
        
        function exportTableToCSV(tableId, filename) {
            const table = document.getElementById(tableId);
            let csv = [];
            
            
            const headers = Array.from(table.querySelectorAll('thead th')).map(th => th.textContent);
            csv.push(headers.join(','));
            
            
            table.querySelectorAll('tbody tr').forEach(row => {
                const cells = Array.from(row.querySelectorAll('td')).map(td => {
                    let text = td.textContent.trim();
                    
                    if (text.includes(',') || text.includes('"')) {
                        text = '"' + text.replace(/"/g, '""') + '"';
                    }
                    return text;
                });
                csv.push(cells.join(','));
            });
            
            
            const blob = new Blob([csv.join('\n')], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        }
        
        
        function resetTopology() {
            
            if (typeof createNetworkDiagram === 'function') {
                const container = document.getElementById('network-diagram');
                container.innerHTML = '';
                createNetworkDiagram(container, networkData);
            }
        }
        
        
        function filterTCPFlows(searchText) {
            const table = document.getElementById('tcp-flow-table');
            if (!table) return;
            
            const rows = table.querySelectorAll('tbody tr.tcp-flow-row');
            const search = searchText.toLowerCase().trim();
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }
        
        
        let tcpSortDirection = {};
        function sortTCPTable(columnIndex) {
            const table = document.getElementById('tcp-flow-table');
            if (!table) return;
            
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr.tcp-flow-row'));
            
            
            tcpSortDirection[columnIndex] = !tcpSortDirection[columnIndex];
            const ascending = tcpSortDirection[columnIndex];
            
            rows.sort((a, b) => {
                let aVal = a.cells[columnIndex].textContent.trim();
                let bVal = b.cells[columnIndex].textContent.trim();
                
                
                if (columnIndex === 3 || columnIndex === 4) {
                    aVal = parseInt(aVal) || 0;
                    bVal = parseInt(bVal) || 0;
                    return ascending ? aVal - bVal : bVal - aVal;
                }
                
                
                return ascending ? aVal.localeCompare(bVal) : bVal.localeCompare(aVal);
            });
            
            
            rows.forEach(row => tbody.appendChild(row));
            
            
            const headers = table.querySelectorAll('thead th');
            headers.forEach((th, i) => {
                const icon = th.querySelector('i.fa-sort, i.fa-sort-up, i.fa-sort-down');
                if (icon) {
                    if (i === columnIndex) {
                        icon.className = ascending ? 'fas fa-sort-up' : 'fas fa-sort-down';
                    } else {
                        icon.className = 'fas fa-sort';
                    }
                }
            });
        }
        
        
        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(() => {
                const icon = button.querySelector('i');
                const originalClass = icon.className;
                icon.className = 'fas fa-check';
                button.style.background = '#00B894';
                button.style.color = 'white';
                button.style.borderColor = '#00B894';
                
                setTimeout(() => {
                    icon.className = originalClass;
                    button.style.background = '';
                    button.style.color = '';
                    button.style.borderColor = '';
                }, 1500);
            }).catch(err => {
                console.error('Failed to copy:', err);
                
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            });
        }
        
        
        function initializeVisualizations() {
            try {
                if (networkData && networkData.nodes && networkData.nodes.length > 0) {
                    createNetworkDiagram(document.getElementById('network-diagram'), networkData);
                }
                
                if (timelineData && timelineData.length > 0) {
                    createTimeline(document.getElementById('timeline'), timelineData);
                }
                
                if (sankeyData && sankeyData.nodes && sankeyData.nodes.length > 0) {
                    createSankeyDiagram(document.getElementById('sankey-diagram'), sankeyData);
                }
                
                if (rttHistogramData && rttHistogramData.length > 0) {
                    createRTTHistogram(document.getElementById('rtt-histogram'), rttHistogramData);
                }
            } catch (error) {
                console.error('Error initializing visualizations:', error);
            }
        }
        
        
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(initializeVisualizations, 100);
        });
    </script>
    
    
    <script>// SD-WAN Triage Report Visualizations - Simplified Implementation
// Clean, minimal D3.js force-directed graph

// Theme-aware color utilities
function getThemeColors() {
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
    return {
        primary: '#3b82f6',
        success: '#10b981',
        warning: '#f59e0b',
        danger: '#ef4444',
        text: isDark ? '#f1f5f9' : '#1e293b',
        background: isDark ? '#1e293b' : '#ffffff',
        border: isDark ? '#334155' : '#e2e8f0'
    };
}

// Network Diagram - Simple, Clean Force-Directed Graph
function createNetworkDiagram(container, data) {
    // Clear existing content
    d3.select(container).selectAll("*").remove();
    
    // Validate data
    if (!data || !data.nodes || !data.links || data.nodes.length === 0) {
        container.innerHTML = '<div style="padding: 40px; text-align: center; color: #64748b;">No network data available</div>';
        return;
    }
    
    // Dimensions
    const width = container.clientWidth || 800;
    const height = 500;
    
    // Create SVG with white background
    const svg = d3.select(container)
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "#ffffff")
        .style("border", "1px solid #e0e0e0")
        .style("border-radius", "8px");
    
    // Create main group for zoom/pan
    const g = svg.append("g");
    
    // Add zoom behavior
    svg.call(d3.zoom()
        .scaleExtent([0.5, 3])
        .on("zoom", (event) => g.attr("transform", event.transform)));
    
    // Define arrowhead marker - CRITICAL: markerUnits prevents scaling issues
    svg.append("defs")
        .append("marker")
        .attr("id", "arrow")
        .attr("viewBox", "0 -5 10 10")
        .attr("refX", 12)
        .attr("refY", 0)
        .attr("markerWidth", 3)
        .attr("markerHeight", 3)
        .attr("markerUnits", "strokeWidth")
        .attr("orient", "auto")
        .append("path")
        .attr("d", "M0,-5L10,0L0,5")
        .attr("fill", "#94a3b8");
    
    // Simple color mapping
    const nodeColors = {
        "internal": "#10b981",
        "router": "#3b82f6",
        "external": "#f59e0b",
        "anomaly": "#ef4444"
    };
    
    // Create tooltip
    const tooltip = d3.select("body")
        .append("div")
        .attr("class", "d3-tooltip")
        .style("position", "absolute")
        .style("opacity", 0)
        .style("background", "rgba(0,0,0,0.8)")
        .style("color", "white")
        .style("padding", "8px 12px")
        .style("border-radius", "4px")
        .style("font-size", "12px")
        .style("pointer-events", "none")
        .style("z-index", "10000");
    
    // Simple force simulation
    const simulation = d3.forceSimulation(data.nodes)
        .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
        .force("charge", d3.forceManyBody().strength(-300))
        .force("center", d3.forceCenter(width / 2, height / 2))
        .force("collision", d3.forceCollide().radius(30));
    
    // Draw links
    const link = g.append("g")
        .selectAll("line")
        .data(data.links)
        .join("line")
        .attr("stroke", d => d.hasIssue ? "#ef4444" : "#cbd5e1")
        .attr("stroke-width", d => {
            const bytes = d.value || 0;
            if (bytes > 10000000) return 3;
            if (bytes > 1000000) return 2;
            return 1;
        })
        .attr("stroke-dasharray", d => d.hasIssue ? "4,4" : "0")
        .attr("marker-end", "url(#arrow)");
    
    // Draw nodes
    const node = g.append("g")
        .selectAll("circle")
        .data(data.nodes)
        .join("circle")
        .attr("r", d => d.group === "router" ? 10 : 8)
        .attr("fill", d => nodeColors[d.group] || "#94a3b8")
        .attr("stroke", "#fff")
        .attr("stroke-width", 2)
        .style("cursor", "pointer")
        .call(d3.drag()
            .on("start", dragStarted)
            .on("drag", dragged)
            .on("end", dragEnded))
        .on("mouseover", function(event, d) {
            d3.select(this)
                .attr("stroke-width", 3)
                .attr("r", d.group === "router" ? 12 : 10);
            
            tooltip.transition().duration(200).style("opacity", 1);
            tooltip.html(`
                <strong>${d.id}</strong><br/>
                Type: ${d.group}<br/>
                ${d.bytes ? `Traffic: ${formatBytes(d.bytes)}` : ''}
            `)
                .style("left", (event.pageX + 10) + "px")
                .style("top", (event.pageY - 10) + "px");
        })
        .on("mouseout", function(event, d) {
            d3.select(this)
                .attr("stroke-width", 2)
                .attr("r", d.group === "router" ? 10 : 8);
            
            tooltip.transition().duration(500).style("opacity", 0);
        });
    
    // Add labels
    const label = g.append("g")
        .selectAll("text")
        .data(data.nodes)
        .join("text")
        .text(d => d.id)
        .attr("font-size", "11px")
        .attr("dx", 12)
        .attr("dy", 4)
        .attr("fill", "#1e293b")
        .attr("stroke", "#fff")
        .attr("stroke-width", 3)
        .attr("paint-order", "stroke")
        .style("pointer-events", "none");
    
    // Update positions on simulation tick
    simulation.on("tick", () => {
        link
            .attr("x1", d => d.source.x)
            .attr("y1", d => d.source.y)
            .attr("x2", d => d.target.x)
            .attr("y2", d => d.target.y);
        
        node
            .attr("cx", d => d.x)
            .attr("cy", d => d.y);
        
        label
            .attr("x", d => d.x)
            .attr("y", d => d.y);
    });
    
    // Drag functions
    function dragStarted(event, d) {
        if (!event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
    }
    
    function dragged(event, d) {
        d.fx = event.x;
        d.fy = event.y;
    }
    
    function dragEnded(event, d) {
        if (!event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }
    
    // Helper function
    function formatBytes(bytes) {
        if (bytes < 1024) return bytes + ' B';
        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
        if (bytes < 1024 * 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        return (bytes / (1024 * 1024 * 1024)).toFixed(2) + ' GB';
    }
    
    // Add simple legend
    const legend = svg.append("g")
        .attr("transform", `translate(20, ${height - 120})`);
    
    legend.append("rect")
        .attr("width", 160)
        .attr("height", 110)
        .attr("fill", "rgba(255,255,255,0.95)")
        .attr("stroke", "#e0e0e0")
        .attr("rx", 4);
    
    const legendItems = [
        { label: "Internal", color: "#10b981" },
        { label: "Router", color: "#3b82f6" },
        { label: "External", color: "#f59e0b" },
        { label: "Anomaly", color: "#ef4444" }
    ];
    
    legendItems.forEach((item, i) => {
        const lg = legend.append("g")
            .attr("transform", `translate(10, ${i * 25 + 15})`);
        
        lg.append("circle")
            .attr("r", 6)
            .attr("fill", item.color)
            .attr("stroke", "#fff")
            .attr("stroke-width", 1);
        
        lg.append("text")
            .attr("x", 15)
            .attr("y", 4)
            .attr("font-size", "12px")
            .attr("fill", "#1e293b")
            .text(item.label);
    });
}

// Placeholder functions for other visualizations
function createTimeline(container, data) {
    container.innerHTML = '<div style="padding: 20px; text-align: center; color: #64748b;">Timeline visualization</div>';
}

function createSankeyDiagram(container, data) {
    container.innerHTML = '<div style="padding: 20px; text-align: center; color: #64748b;">Sankey diagram</div>';
}

function createRTTHistogram(container, data) {
    container.innerHTML = '<div style="padding: 20px; text-align: center; color: #64748b;">RTT histogram</div>';
}
</script>
</body>
</html>
